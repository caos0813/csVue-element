webpackJsonp([0],{"1ZYa":function(e,a){},L0Lu:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var l=t("5aCZ"),s=t("0xDb"),i=t("bGai"),r={data:function(){return{rules:{title:[{required:!0,message:"请输入专题名称",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}],textarea:[{required:!0,message:"请输入音频描述",trigger:"blur"}],image:[{type:"string",required:!0,message:"请上传封面",trigger:"blur"}],audioPath:[{required:!0,message:"请上传音频",trigger:"blur"}],pickerVal:[{required:!0,validator:function(e,a,t){a.length<2?t(new Error("请选择产品分类和专题")):t()},trigger:"change"}]},params:{title:"",isHomePageShow:0,audioFlag:0,pickerVal:[],image:""},isAudioFlag:!1,timeDialog:!1,addForm:{publishTime:""},pickerOptions2:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},formRules:{publishTime:[{type:"date",required:!0,message:"时间不能为空",trigger:"change"}]}}},components:{upload:i.d,Tinymce:l.a,picker:i.c},methods:{release:function(){this.postData("form",s.a.articlePublishNow,1)},timeRelease:function(){var e=this;this.$refs.form.validate(function(a){a&&(e.timeDialog=!0,e.$refs.addForm&&e.$refs.addForm.resetFields())})},save:function(){this.postData("addForm",s.a.articlePublishDelay,4)},cancel:function(){this.$refs.addForm.resetFields(),this.timeDialog=!1},submit:function(){this.postData("form",s.a.articleHandle,2)},postData:function(e,a,t){var l=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var s=l.params,i=s.title,r=s.isHomePageShow,o=s.image,n=s.pickerVal,c=s.id,u=s.content,p=s.audioPath,m=s.audioFlag,d=s.textarea;console.log(l.params);var g=l.timeDialog?new Date(l.addForm.publishTime).getTime():null;l.$fly.post(a,{id:c,title:i,audioPath:m?p:null,isHomePageShow:r,publishTime:g,image:m?null:o,content:m?d:u,specialTopicId:n[1],productId:n[0],status:t}).then(function(e){console.log(e),l.$message({message:"保存成功",duration:2e3,type:"success"}),l.$refs.form.resetFields(),l.timeDialog=!1,l.goBack()}).catch(function(){l.$message({message:"保存失败",duration:2e3,type:"error"})})})}},created:function(){var e=this,a=this.$route.params.type,t=this.$route.query.id;"edit"===a&&this.$fly.get(s.a.articleDetail,{id:t}).then(function(a){e.params=a,console.log(e.lodash.isNull(a.audioPath)),e.lodash.isNull(a.audioPath)?(e.params.audioFlag=0,e.isAudioFlag=!0):(e.params.audioFlag=1,e.isAudioFlag=!0,e.params.textarea=a.content),e.params.pickerVal=[a.product.id,a.specialTopic.id]})}},o={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"page"},[t("div",{staticClass:"tools-bar"},[t("div",{staticClass:"left-wrap"},[t("back")],1),e._v(" "),t("div",{staticClass:"button-wrap"},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.release}},[e._v("直接发布")]),e._v(" "),t("el-button",{attrs:{type:"info",size:"small"},on:{click:e.timeRelease}},[e._v("定时发布")]),e._v(" "),t("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.submit}},[e._v("草稿")])],1)]),e._v(" "),t("el-form",{ref:"form",attrs:{model:e.params,rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"专题",prop:"pickerVal"}},[t("picker",{attrs:{column:2},model:{value:e.params.pickerVal,callback:function(a){e.$set(e.params,"pickerVal",a)},expression:"params.pickerVal"}}),e._v(" "),t("el-col",{attrs:{span:4}},[t("el-form-item",{attrs:{"label-width":"20px"}},[[t("el-checkbox",{attrs:{"true-label":1,"false-label":0,disabled:e.isAudioFlag},model:{value:e.params.audioFlag,callback:function(a){e.$set(e.params,"audioFlag",a)},expression:"params.audioFlag"}},[e._v("音频")])]],2)],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"标题",prop:"title"}},[t("el-col",{attrs:{span:12}},[t("el-input",{model:{value:e.params.title,callback:function(a){e.$set(e.params,"title",a)},expression:"params.title"}})],1),e._v(" "),t("el-col",{attrs:{span:4}},[t("el-form-item",{attrs:{"label-width":"20px"}},[[t("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.params.isHomePageShow,callback:function(a){e.$set(e.params,"isHomePageShow",a)},expression:"params.isHomePageShow"}},[e._v("首页显示")])]],2)],1)],1),e._v(" "),1===e.params.audioFlag?t("div",[t("el-form-item",{attrs:{label:"音频",prop:"audioPath"}},[t("upload",{attrs:{type:"audio",accept:"audio/*",path:"audio/article/"},model:{value:e.params.audioPath,callback:function(a){e.$set(e.params,"audioPath",a)},expression:"params.audioPath"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"音频描述",prop:"textarea"}},[t("el-col",{attrs:{span:12}},[t("el-input",{attrs:{placeholder:"请输入音频描述",type:"textarea",rows:6},model:{value:e.params.textarea,callback:function(a){e.$set(e.params,"textarea",a)},expression:"params.textarea"}})],1)],1)],1):e._e(),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:1!==e.params.audioFlag,expression:"params.audioFlag!==1"}]},[t("el-form-item",{attrs:{label:"封面",prop:e.params.audioFlag?"":"image"}},[t("upload",{attrs:{path:"image/article/"},model:{value:e.params.image,callback:function(a){e.$set(e.params,"image",a)},expression:"params.image"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:e.params.audioFlag?"":"content"}},[t("el-col",{attrs:{span:18}},[t("Tinymce",{ref:"editor",attrs:{height:600},model:{value:e.params.content,callback:function(a){e.$set(e.params,"content",a)},expression:"params.content"}})],1)],1)],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"定时发布",visible:e.timeDialog,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(a){e.timeDialog=a}}},[t("el-form",{ref:"addForm",attrs:{model:e.addForm,"inline-message":"",rules:e.formRules,"label-suffix":":","label-width":"100"}},[t("el-form-item",{attrs:{label:"发布时间",prop:"publishTime"}},[t("el-col",{attrs:{span:12}},[t("el-date-picker",{staticClass:"full",attrs:{type:"datetime","picker-options":e.pickerOptions2,placeholder:"请选择发布时间"},model:{value:e.addForm.publishTime,callback:function(a){e.$set(e.addForm,"publishTime",a)},expression:"addForm.publishTime"}})],1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancel}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[]};var n=t("VU/8")(r,o,!1,function(e){t("1ZYa")},"data-v-5cc94846",null);a.default=n.exports},ZGGE:function(e,a){},eutC:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var l=t("0xDb"),s=t("bGai"),i={data:function(){return{params:{title:null,page:1,size:15,sortType:1},checkIds:[],pickerVal:[],pageInfo:{},tableData:[]}},components:{picker:s.c,listHandle:s.b},methods:{handleSelectionChange:function(e){this.checkIds=this.lodash.map(e,"id"),console.log(this.checkIds)},changePage:function(e){this.params.page=e,this.getData(this.params)},reset:function(){this.params={title:null,page:1,size:15,sortType:1},this.pickerVal=[],this.getData(this.params)},search:function(){console.log(this.pickerVal),this.params.productId=this.pickerVal[0],this.params.specialTopicId=this.pickerVal[1],this.getData(this.params)},refresh:function(){this.getData(this.params)},getData:function(e){var a=this,t=this.lodash.clone(e);t.page--,console.log(e),this.$fly.get(l.a.articleList,t).then(function(t){a.tableData=t.content,a.pageInfo={totalPages:t.totalPages,size:e.size,currentPage:e.page}})}},created:function(){this.getData(this.params)}},r={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"page"},[t("div",{staticClass:"tools-bar"},[t("div",{staticClass:"left-wrap"},[t("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"请输入搜索关键字",size:"small"},model:{value:e.params.title,callback:function(a){e.$set(e.params,"title",a)},expression:"params.title"}}),e._v(" "),t("picker",{attrs:{size:"small",span:-1,column:2},model:{value:e.pickerVal,callback:function(a){e.pickerVal=a},expression:"pickerVal"}}),e._v(" "),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.search}},[e._v("查询")]),e._v(" "),t("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.reset}},[e._v("重置")])],1),e._v(" "),t("listHandle",{attrs:{checkIds:e.checkIds},on:{refresh:e.refresh}})],1),e._v(" "),t("el-table",{ref:"multipleTable",attrs:{"header-cell-class-name":"tableHeader",data:e.tableData,border:"",stripe:""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"标题",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.title))])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"推荐",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{size:"small",type:1===a.row.isHomePageShow?"danger":"info"}},[e._v(e._s(a.row.isHomePageShow?"推荐":"不推荐"))])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"所属专题",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(e._s(a.row.product.name)+"、"+e._s(a.row.specialTopic.title))]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"userName",label:"操作人",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"状态",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{size:"small",type:e._f("publicStatus")(a.row.status,"style")}},[e._v(e._s(e._f("publicStatus")(a.row.status)))])]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"totalReadNum",label:"阅读量",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v("\n        "+e._s(a.row.totalReadNum)+"\n      ")]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"创建时间",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(e._s(e._f("dateTime")(a.row.createTime,"yyyy-MM-dd hh:mm:ss")))]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"发布时间",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(e._s(e._f("dateTime")(a.row.publishTime,"yyyy-MM-dd hh:mm:ss")))]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"操作",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text ",size:"mini"}},[t("router-link",{attrs:{to:{name:"article",params:{type:"edit"},query:{id:a.row.id}},tag:"span"}},[e._v("编辑")])],1)]}}])})],1),e._v(" "),t("div",{staticClass:"page-wrap"},[t("el-pagination",{attrs:{background:"",layout:"prev, pager, next ","current-page":e.pageInfo.currentPage,"page-count":e.pageInfo.totalPages,"page-size":e.pageInfo.size},on:{"current-change":e.changePage}})],1)],1)},staticRenderFns:[]};var o=t("VU/8")(i,r,!1,function(e){t("ZGGE")},"data-v-d6abcefe",null);a.default=o.exports}});