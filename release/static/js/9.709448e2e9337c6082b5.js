webpackJsonp([9],{Oo84:function(n,e,t){(n.exports=t("FZ+f")(!0)).push([n.i,'\n.page[data-v-18128332] {\n  padding: 53px 0 0;\n  margin: 0 -20px;\n  height: 100%;\n}\n.page .tools-bar[data-v-18128332] {\n    -webkit-box-pack: end;\n        -ms-flex-pack: end;\n            justify-content: flex-end;\n}\n.page .body[data-v-18128332] {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    height: 100%;\n}\n.page .body .left-wrap[data-v-18128332] {\n      width: 300px;\n      position: relative;\n      height: 100%;\n      padding: 10px 0;\n}\n.page .body .left-wrap[data-v-18128332]::after {\n        content: "";\n        position: absolute;\n        top: 0px;\n        right: 0px;\n        bottom: 0px;\n        width: 1px;\n        background-color: #eee;\n        height: 100%;\n}\n.page .body .left-wrap .role[data-v-18128332] {\n        width: 100%;\n}\n.page .body .left-wrap .role > li[data-v-18128332] {\n          -webkit-box-flex: 1;\n              -ms-flex: 1;\n                  flex: 1;\n}\n.page .body .left-wrap .role > li > div[data-v-18128332] {\n            display: -webkit-box;\n            display: -ms-flexbox;\n            display: flex;\n            -webkit-box-align: center;\n                -ms-flex-align: center;\n                    align-items: center;\n            -webkit-box-pack: justify;\n                -ms-flex-pack: justify;\n                    justify-content: space-between;\n            font-size: 14px;\n            padding: 0 15px;\n}\n.page .body .left-wrap .role > li > div > label[data-v-18128332]:hover {\n              cursor: pointer;\n}\n.page .body .left-wrap .role > li[data-v-18128332]:hover {\n            background-color: #f5f7fa;\n            cursor: pointer;\n}\n.page .body .left-wrap .role > li.liActive[data-v-18128332] {\n            background-color: #f5f7fa;\n}\n.page .body .left-wrap .add-role[data-v-18128332] {\n        padding: 0 15px;\n}\n.page .body .left-wrap .add-role .el-form-item__content[data-v-18128332] {\n          display: -webkit-box;\n          display: -ms-flexbox;\n          display: flex;\n          -webkit-box-pack: justify;\n              -ms-flex-pack: justify;\n                  justify-content: space-between;\n}\n.page .body .left-wrap .add-role .el-form-item__content .el-input[data-v-18128332] {\n            width: calc(100% - 81px);\n}\n.page .body .left-wrap .add-role .el-form-item__content .el-button[data-v-18128332] {\n            height: 30px;\n            margin-left: 10px;\n}\n.page .body .left-wrap .add-role .el-form-item__content .role-name[data-v-18128332] .el-input__inner {\n            height: 30px;\n            border: none;\n            border-radius: 0;\n            border-bottom: 1px solid #dcdfe6;\n            padding: 0;\n}\n.page .body .right-wrap[data-v-18128332] {\n      -webkit-box-flex: 1;\n          -ms-flex: 1;\n              flex: 1;\n      padding: 10px 0;\n      margin-left: 5px;\n}\n',"",{version:3,sources:["D:/work/junyang_admin/src/pages/system/D:/work/junyang_admin/src/pages/system/authority.vue"],names:[],mappings:";AAyaA;EACE,kBAAiB;EACjB,gBAAe;EACf,aAAY;CA4Eb;AA/ED;IAKI,sBAAyB;QAAzB,mBAAyB;YAAzB,0BAAyB;CAC1B;AANH;IAQI,qBAAa;IAAb,qBAAa;IAAb,cAAa;IACb,aAAY;CAqEb;AA9EH;MAWM,aAAY;MACZ,mBAAkB;MAClB,aAAY;MACZ,gBAAe;CA0DhB;AAxEL;QAgBQ,YAAW;QACX,mBAAkB;QAClB,SAAQ;QACR,WAAU;QACV,YAAW;QACX,WAAU;QACV,uBA7bE;QA8bF,aAAY;CACb;AAxBP;QA0BQ,YAAW;CAsBZ;AAhDP;UA4BU,oBAAO;cAAP,YAAO;kBAAP,QAAO;CAmBR;AA/CT;YA8BY,qBAAa;YAAb,qBAAa;YAAb,cAAa;YACb,0BAAmB;gBAAnB,uBAAmB;oBAAnB,oBAAmB;YACnB,0BAA8B;gBAA9B,uBAA8B;oBAA9B,+BAA8B;YAC9B,gBAhcM;YAicN,gBAAe;CAKhB;AAvCX;cAqCc,gBAAe;CAChB;AAtCb;YAyCY,0BA7cM;YA8cN,gBAAe;CAChB;AA3CX;YA6CY,0BAjdM;CAkdP;AA9CX;QAkDQ,gBAAe;CAqBhB;AAvEP;UAoDU,qBAAa;UAAb,qBAAa;UAAb,cAAa;UACb,0BAA8B;cAA9B,uBAA8B;kBAA9B,+BAA8B;CAiB/B;AAtET;YAuDY,yBAAwB;CACzB;AAxDX;YA0DY,aAAY;YACZ,kBAAiB;CAClB;AA5DX;YA+Dc,aAAY;YACZ,aAAY;YACZ,iBAAgB;YAChB,iCAveI;YAweJ,WAAU;CACX;AApEb;MA0EM,oBAAO;UAAP,YAAO;cAAP,QAAO;MACP,gBAAe;MACf,iBAAgB;CACjB",file:"authority.vue",sourcesContent:['$light:#fff;\r\n$black:#000;\r\n$gray:#eee;\r\n$gray-ee:#eef1f6;\r\n$stable-dc:#dcdfe6;\r\n$stable-f5:#f5f7fa;\r\n$dark03:#303133 !default;\r\n$color-primary: #409EFF !default;\r\n\r\n$font-size-12:12px;\r\n$font-size-14:14px;\r\n$font-size-16:16px;\r\n$font-size-18:18px;\r\n$font-size-20:20px;\r\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.page {\r\n  padding: 53px 0 0;\r\n  margin: 0 -20px;\r\n  height: 100%;\r\n  .tools-bar {\r\n    justify-content: flex-end;\r\n  }\r\n  .body {\r\n    display: flex;\r\n    height: 100%;\r\n    .left-wrap {\r\n      width: 300px;\r\n      position: relative;\r\n      height: 100%;\r\n      padding: 10px 0;\r\n      &::after {\r\n        content: "";\r\n        position: absolute;\r\n        top: 0px;\r\n        right: 0px;\r\n        bottom: 0px;\r\n        width: 1px;\r\n        background-color: $gray;\r\n        height: 100%;\r\n      }\r\n      .role {\r\n        width: 100%;\r\n        > li {\r\n          flex: 1;\r\n          > div {\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: space-between;\r\n            font-size: $font-size-14;\r\n            padding: 0 15px;\r\n            // border: 1px solid red;\r\n            > label:hover {\r\n              cursor: pointer;\r\n            }\r\n          }\r\n          &:hover {\r\n            background-color: $stable-f5;\r\n            cursor: pointer;\r\n          }\r\n          &.liActive {\r\n            background-color: $stable-f5;\r\n          }\r\n        }\r\n      }\r\n      .add-role {\r\n        padding: 0 15px;\r\n        .el-form-item__content {\r\n          display: flex;\r\n          justify-content: space-between;\r\n          .el-input {\r\n            width: calc(100% - 81px);\r\n          }\r\n          .el-button {\r\n            height: 30px;\r\n            margin-left: 10px;\r\n          }\r\n          .role-name {\r\n            /deep/ .el-input__inner {\r\n              height: 30px;\r\n              border: none;\r\n              border-radius: 0;\r\n              border-bottom: 1px solid $stable-dc;\r\n              padding: 0;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    .right-wrap {\r\n      flex: 1;\r\n      padding: 10px 0;\r\n      margin-left: 5px;\r\n    }\r\n  }\r\n}\r\n'],sourceRoot:""}])},et2I:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=t("bGai"),r=t("0xDb"),i=t("lbHh"),s=t.n(i),o={data:function(){return{data:[{name:"全部",subNav:Object(r.d)()}],defaultProps:{children:"subNav",label:"name"},checkedKeys:[],checkedNames:[],roleData:[],defaultProps1:{children:"children",label:"label"},isAdd:!1,isEdit:!1,roleForm:{roleName:""},roleRules:{roleName:{required:!0,message:"角色名不能为空",trigger:"blur"}},loading:!1,liActive:{},oldRoleName:""}},components:{listHandle:a.c},methods:{append:function(){var n=this;this.isEdit?this.$message.error("有角色信息未保存"):(this.isAdd=!0,this.roleForm.roleName="",this.$nextTick(function(){n.liActive={},n.roleData.map(function(n){n.isActive=!1}),n.$refs.roleName.focus()}))},checked:function(n,e){var t=this;this.checkedNames=[],e.checkedNodes.map(function(n){n.subNav||("string"==typeof n.auth?t.checkedNames.push({name:n.auth}):t.checkedNames.push({name:n.auth()}))})},save:function(n,e){var t=this;""!==n?this.$refs.roleForm[e].validate(function(a){a&&t.save_post(n,t.roleForm.roleName,e,"roleForm","")}):this.$refs.addRoleForm.validate(function(a){a&&t.save_post(n,t.roleForm.roleName,e,"addRoleForm","")})},save_post:function(n,e,t,a,i){var s=this;n=""===n?null:n,""!==e?this.isAdd||this.isEdit&&""!==this.oldRoleName&&this.oldRoleName!==e?this.$fly.post(r.a.roleIsExist,{name:e}).then(function(r){if(1e5===r.status){if(r.data)return s.$message({message:"保存失败，角色名已存在",type:"error"}),!1;s.roleSavePost(n,e,t,a,i)}else s.$message({message:"查询失败",type:"error"})}):this.roleSavePost(n,e,t,a,i):this.$message({message:"角色名不能为空",duration:2e3,type:"error"})},roleSavePost:function(n,e,t,a,i){var o=this,l=s.a.getJSON("user").rolesName;this.$fly.post(r.a.roleSave,{id:null===n?null:n.id,name:e,authorities:this.checkedNames}).then(function(e){1e5===e.status?(o.$message({message:"保存成功",type:"success"}),o.$refs.tree.setCheckedKeys([]),o.getRoles(),"saveAll"===i?(o.liActive.name===l&&o.signOut("您修改了当前用户所属角色的权限，请重新登录"),n.isEdit=!1,o.isEdit=!1):"roleForm"===a?(n.isEdit=!1,o.isEdit=!1,o.$refs[""+a][t].resetFields(),n.name===l&&o.signOut("您修改了当前用户所属的角色，请重新登录")):(o.isAdd=!1,o.$refs[""+a].resetFields())):o.$message({message:"保存失败",type:"error"})}).catch(function(){o.$message({message:"请求失败",duration:2e3,type:"error"})})},saveAll:function(){if("超级管理员"!==this.liActive.name)if(this.isAdd)this.$message.error("有角色信息未保存");else if(this.lodash.isUndefined(this.liActive.name))this.$message({message:"请先选择角色",duration:2e3,type:"error"});else{var n=void 0;n=""===this.roleForm.roleName?this.liActive.name:this.roleForm.roleName,this.save_post(this.liActive,n,"","","saveAll")}else this.$message({message:"无法修改超级管理员的权限",duration:2e3,type:"info"})},cancel:function(n,e){""!==n?(n.isEdit=!1,this.isEdit=!1,this.$refs.roleForm[e].resetFields()):(this.isAdd=!1,this.$refs.addRoleForm.resetFields())},edit:function(n,e){if(this.isAdd)this.$message.error("有角色信息未保存");else{n.isEdit=!0,this.isEdit=!0;for(var t=this.roleData,a=0;a<t.length;a++)t[a].id!==n.id&&(t[a].isEdit=!1);this.roleForm.roleName=n.name,this.liActive=n,this.oldRoleName=n.name,this.roleClick(n)}},remove:function(n){var e=this;Object(r.b)("您确定删除角色' "+n.name+" '吗？","提示").then(function(){var t=[];t.push(n.id),e.$fly.post(r.a.roleDelete,t).then(function(t){1e5===t.status?(e.$message({showClose:!0,type:"success",message:"删除成功"}),e.$refs.tree.setCheckedKeys([]),n.name===s.a.getJSON("user").rolesName?e.signOut("您删除了当前用户所属的角色，请重新登录"):e.getRoles()):e.$message({showClose:!0,type:"error",message:"删除失败"})}).catch(function(){e.$message({message:"请求失败",duration:2e3,type:"error"})})})},signOut:function(n){var e=this;this.$message({message:""+n,type:"warning"}),setTimeout(function(){s.a.remove("user"),e.$router.replace({name:"login"})},500)},roleClick:function(n){if(!n.isActive){for(var e=this.roleData,t=0;t<e.length;t++)e[t].id!==n.id?e[t].isActive=!1:(n.isActive=!0,this.liActive=n);this.liActiveId=n.id,this.$refs.tree.setCheckedKeys([]),this.getAuth(n)}},getAuth:function(n){var e=this;this.loading=!0;var t=[];this.$fly.get(r.a.roleGetOne,{id:n.id}).then(function(n){setTimeout(function(){e.loading=!1},1e3);var a=[],r=[];n.data.authorities.map(function(n){t.push(n.name)}),t.map(function(n){e.hasAuth(n)&&e.data[0].subNav.map(function(e){e.subNav.map(function(e){e.subNav?e.subNav.map(function(e){n===e.auth&&(a.push(e.id),r.push({name:e.auth}))}):n===e.auth()&&(a.push(e.id),r.push({name:e.auth()}))})})}),e.$set(e,"checkedKeys",a),e.checkedNames=r}).catch(function(){e.$message({message:"删除失败",duration:2e3,type:"error"})})},getRoles:function(){var n=this;this.$fly.get(r.a.getRoles).then(function(e){e.data.RoleList.map(function(n){n.isEdit=!1,n.isActive=!1}),n.roleData=e.data.RoleList}).catch(function(){n.$message({message:"请求失败",duration:2e3,type:"error"})})}},created:function(){this.getRoles()}},l=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"page"},[t("div",{staticClass:"tools-bar btn-wrap"},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return e.stopPropagation(),n.append(e)}}},[n._v("新增")]),n._v(" "),t("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(e){return e.stopPropagation(),n.saveAll(e)}}},[n._v("保存")])],1),n._v(" "),t("div",{staticClass:"body"},[t("div",{staticClass:"left-wrap"},[t("ul",{staticClass:"role"},n._l(n.roleData,function(e,a){return t("li",{key:a,class:{liActive:e.isActive}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isEdit,expression:"!item.isEdit"}],on:{click:function(t){t.stopPropagation(),t.preventDefault(),n.roleClick(e)}}},[t("label",[n._v(n._s(e.name))]),n._v(" "),"超级管理员"!==e.name?t("label",[t("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(t){t.stopPropagation(),t.preventDefault(),n.edit(e,a)}}},[n._v("\n                编辑\n              ")]),n._v(" "),t("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(t){t.stopPropagation(),t.preventDefault(),n.remove(e)}}},[n._v("\n                删除\n              ")])],1):n._e()]),n._v(" "),t("el-form",{directives:[{name:"show",rawName:"v-show",value:e.isEdit,expression:"item.isEdit"}],ref:"roleForm",refInFor:!0,staticClass:"add-role",attrs:{model:n.roleForm,rules:n.roleRules}},[t("el-form-item",{attrs:{prop:"roleName"}},[t("el-input",{ref:"editRoleName",refInFor:!0,staticClass:"role-name",attrs:{placeholder:"请输入角色名",autofocus:""},model:{value:n.roleForm.roleName,callback:function(e){n.$set(n.roleForm,"roleName",e)},expression:"roleForm.roleName"}}),n._v(" "),t("label",{staticClass:"btn-wrap"},[t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){t.stopPropagation(),t.preventDefault(),n.save(e,a)}}},[n._v("保存")]),n._v(" "),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){t.stopPropagation(),t.preventDefault(),n.cancel(e,a)}}},[n._v("取消")])],1)],1)],1)],1)})),n._v(" "),n.isAdd?t("el-form",{ref:"addRoleForm",staticClass:"add-role",attrs:{model:n.roleForm,rules:n.roleRules}},[t("el-form-item",{attrs:{prop:"roleName"}},[t("el-input",{ref:"roleName",staticClass:"role-name",attrs:{placeholder:"请输入角色名",autofocus:""},model:{value:n.roleForm.roleName,callback:function(e){n.$set(n.roleForm,"roleName",e)},expression:"roleForm.roleName"}}),n._v(" "),t("label",{staticClass:"btn-wrap"},[t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){e.stopPropagation(),n.save("")}}},[n._v("保存")]),n._v(" "),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){e.stopPropagation(),n.cancel("")}}},[n._v("取消")])],1)],1)],1):n._e()],1),n._v(" "),t("div",{staticClass:"right-wrap"},[t("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],ref:"tree",attrs:{data:n.data,"show-checkbox":"","default-expand-all":"","default-checked-keys":n.checkedKeys,"node-key":"id",props:n.defaultProps},on:{check:n.checked}})],1)])])};l._withStripped=!0;var d={render:l,staticRenderFns:[]},A=d;var c=!1;var p=t("VU/8")(o,A,!1,function(n){c||t("uqRH")},"data-v-18128332",null);p.options.__file="src/pages/system/authority.vue";e.default=p.exports},uqRH:function(n,e,t){var a=t("Oo84");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);t("rjj0")("71f81ef1",a,!1,{})}});
//# sourceMappingURL=9.709448e2e9337c6082b5.js.map