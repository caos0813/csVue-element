webpackJsonp([8],{"7LK4":function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=t("0xDb"),r=t("lbHh"),i=t.n(r),o=t("bGai"),l={data:function(){return{date:null,pickerOptions2:{disabledDate:function(n){return n.getTime()>Date.now()},shortcuts:[{text:"今天",onClick:function(n){n.$emit("pick",[new Date,new Date])}},{text:"最近一周",onClick:function(n){var e=new Date,t=new Date;t.setTime(t.getTime()-6048e5),n.$emit("pick",[t,e])}},{text:"最近一个月",onClick:function(n){var e=new Date,t=new Date;t.setTime(t.getTime()-2592e6),n.$emit("pick",[t,e])}},{text:"最近三个月",onClick:function(n){var e=new Date,t=new Date;t.setTime(t.getTime()-7776e6),n.$emit("pick",[t,e])}}]},searchName:"",tableData:[],pageInfo:{totalElements:0,currentPage:1},loading:!1,addDialog:!1,addForm:{province:"",number:1,type:"FULL_FEATURED"},cardLoading:!1,provinceArr:[],rules:{province:[{required:!0,message:"省份不能为空",trigger:"change"},{validator:function(n,e,t){if("0"===e)return t(new Error("请选择省份"));t()},trigger:"change"}],number:[{type:"number",required:!0,message:"数量不能为空",trigger:"blur"},{validator:function(n,e,t){if(!/^[1-9]\d*$/.test(e))return t(new Error("数量必须是大于0的正整数"));t()},trigger:"blur"}],type:[{required:!0,message:"类型不能为空",trigger:"change"}]}}},computed:{params:function(){return{page:1,beginDate:this.date?this.date[0]:null,endDate:this.date?this.date[1]:null}}},components:{listHandle:o.c,pagination:o.d},methods:{dateChange:function(n){var e=new Date(n[0]),t=new Date(n[1]);n[0]=new Date(e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" 00:00:00").getTime(),n[1]=new Date(t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" 23:59:59").getTime(),this.params.beginDate=n[0],this.params.endDate=n[1],this.getData(this.params)},pagination:function(n){this.params.page=n.page,this.params.size=n.limit,this.getData(this.params)},handlerExprot:function(n){var e=(i.a.get("user")?JSON.parse(i.a.get("user")):"").token;window.location.href=this.$fly.config.baseURL+a.a.exportByRecordId+"/"+n+"?token="+e},openCard:function(){this.addDialog=!0,this.getProvinces(),this.$refs.addForm&&this.$refs.addForm.resetFields()},save:function(){var n=this,e={count:this.addForm.number,provinceId:this.addForm.province,type:this.addForm.type};this.$refs.addForm.validate(function(t){t&&(n.cardLoading=!0,n.$fly.post(a.a.generate,e).then(function(e){n.cardLoading=!1,n.$message({message:"生成成功!",type:"success"}),n.getData(n.params),n.addDialog=!1}).catch(function(){n.$message({message:"生成失败",type:"error"})}))})},resetForm:function(){this.$refs.addForm.resetFields()},getProvinces:function(){var n=this;this.$fly.get(a.a.getProvinces).then(function(e){if(1e5===e.status){var t=e.data;n.provinceArr=t}else n.$message({message:"请求失败",type:"error"})}).catch(function(n){console.log(n)})},getData:function(n){var e=this;n.page--,this.loading=!0,this.$fly.get(a.a.byCondition,n).then(function(t){e.loading=!1;var a=t.content,r=t.totalElements;e.pageInfo={totalElements:parseInt(r),currentPage:n.page+1},e.tableData=a})}},created:function(){this.getData(this.params)},mounted:function(){this.params.size=this.$refs.pageInfo.pageSizes[0]}},s=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"page"},[t("div",{staticClass:"tools-bar"},[t("div",{staticClass:"left-wrap"},[t("el-date-picker",{staticClass:"date-picker-wrap",attrs:{size:"small",type:"daterange","unlink-panels":"","range-separator":"至 ","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":n.pickerOptions2,"value-format":"timestamp"},on:{change:n.dateChange},model:{value:n.date,callback:function(e){n.date=e},expression:"date"}})],1),n._v(" "),t("div",{staticClass:"button-wrap"},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:n.openCard}},[n._v("开卡")])],1)]),n._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],attrs:{data:n.tableData,"header-cell-style":{background:"#F5F7FA"},"element-loading-text":"拼命加载中",border:"",stripe:""}},[t("el-table-column",{attrs:{type:"index",width:"50",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{prop:"username",label:"开卡人",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{prop:"provinceName",label:"开卡省份",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{prop:"type",label:"类型",align:"center"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("span",[n._v(n._s("FULL_FEATURED"===e.row.type?"全功能":"ZHI_YUAN"===e.row.type?"志愿卡":"选科卡"))])]}}])}),n._v(" "),t("el-table-column",{attrs:{prop:"count",label:"数量",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{prop:"activeCount",label:"激活数",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{prop:"createdDate",label:"开卡时间",align:"center"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("span",[n._v(n._s(n._f("dateTime")(e.row.createdDate,"yyyy-MM-dd hh:mm:ss")))])]}}])}),n._v(" "),t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){n.handlerExprot(e.row.id)}}},[n._v("导出")])]}}])})],1),n._v(" "),t("pagination",{ref:"pageInfo",attrs:{total:n.pageInfo.totalElements,page:n.pageInfo.currentPage},on:{"update:page":function(e){n.$set(n.pageInfo,"currentPage",e)},pagination:n.pagination}}),n._v(" "),t("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:n.cardLoading,expression:"cardLoading"}],attrs:{title:"开卡",text:"正在生成",visible:n.addDialog,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(e){n.addDialog=e}}},[t("el-form",{ref:"addForm",attrs:{model:n.addForm,"inline-message":"",rules:n.rules,"label-suffix":":","label-width":"100"}},[t("el-form-item",{attrs:{label:"省份",prop:"province"}},[t("el-select",{attrs:{placeholder:"选择省份"},model:{value:n.addForm.province,callback:function(e){n.$set(n.addForm,"province",e)},expression:"addForm.province"}},[t("el-option",{attrs:{label:"请选择",value:"0"}}),n._v(" "),n._l(n.provinceArr,function(n){return t("el-option",{key:n.id,attrs:{value:n.id,label:n.name}})})],2)],1),n._v(" "),t("el-form-item",{attrs:{label:"数量",prop:"number"}},[t("el-input-number",{staticStyle:{width:"217px"},attrs:{"controls-position":"right"},model:{value:n.addForm.number,callback:function(e){n.$set(n.addForm,"number",e)},expression:"addForm.number"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"类型",prop:"type"}},[t("el-select",{attrs:{placeholder:"选择开卡类型"},model:{value:n.addForm.type,callback:function(e){n.$set(n.addForm,"type",e)},expression:"addForm.type"}},[t("el-option",{attrs:{label:"全功能",value:"FULL_FEATURED"}}),n._v(" "),t("el-option",{attrs:{label:"志愿卡",value:"ZHI_YUAN"}}),n._v(" "),t("el-option",{attrs:{label:"选科卡",value:"XUAN_KE"}})],1)],1)],1),n._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:n.resetForm}},[n._v("重置")]),n._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:n.save}},[n._v("生成卡")])],1)],1)],1)};s._withStripped=!0;var c={render:s,staticRenderFns:[]},d=c;var p=!1;var u=t("VU/8")(l,d,!1,function(n){p||t("xQgL")},null,null);u.options.__file="src/pages/volunteer/card.vue";e.default=u.exports},"7Ow4":function(n,e,t){(n.exports=t("FZ+f")(!0)).push([n.i,"\n.tools-bar .left-wrap .ceil-box {\n  width: auto;\n}\n.el-input-number .el-input__inner {\n  text-align: left;\n}\n","",{version:3,sources:["D:/work/junyang_admin/src/pages/volunteer/D:/work/junyang_admin/src/pages/volunteer/card.vue"],names:[],mappings:";AAgSA;EACE,YAAW;CACZ;AACD;EACE,iBAAgB;CACjB",file:"card.vue",sourcesContent:["$light:#fff;\r\n$black:#000;\r\n$gray:#eee;\r\n$gray-ee:#eef1f6;\r\n$stable-dc:#dcdfe6;\r\n$stable-f5:#f5f7fa;\r\n$dark03:#303133 !default;\r\n$color-primary: #409EFF !default;\r\n\r\n$font-size-12:12px;\r\n$font-size-14:14px;\r\n$font-size-16:16px;\r\n$font-size-18:18px;\r\n$font-size-20:20px;\r\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.tools-bar .left-wrap .ceil-box {\r\n  width: auto;\r\n}\r\n.el-input-number .el-input__inner {\r\n  text-align: left;\r\n}\r\n"],sourceRoot:""}])},xQgL:function(n,e,t){var a=t("7Ow4");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);t("rjj0")("0587e0c2",a,!1,{})}});
//# sourceMappingURL=8.2558ee9f8c488ab5327f.js.map