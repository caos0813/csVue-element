webpackJsonp([23],{WfzK:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=t("0xDb"),s=t("bGai"),a={data:function(){return{form:{version:"",ossUrl:"",product:[1],platform:"android",isProduction:!0},productData:[{id:1,name:"选科"},{id:2,name:"志愿"}],platformData:[{value:"android",label:"android"},{value:"ios",label:"ios"}],rules:{ossUrl:[{required:!0,message:"请上传apk文件",trigger:"blur"}],product:[{required:!0,validator:function(e,r,t){console.log(r.length),r.length<1?t(new Error("请选择产品")):t()},trigger:"change"}],platform:[{required:!0,message:"请选择平台",trigger:"change"}],version:[{required:!0,message:"请输入版本号",trigger:"blur"}]},isExit:!1}},components:{upload:s.f,picker:s.e},computed:{path:function(){var e={url:"test/android/",isProduction:!1};return e}},methods:{save:function(){var e=this;console.log(this.path),this.$refs.form.validate(function(r){r&&""!==e.form.version&&e.VersionIsExit().then(function(r){if(r.data)e.$message({message:"当前产品的平台下已存在此版本号",type:"error"});else{var t=e.form,s=t.product,a=t.platform,l=t.version,i=t.ossUrl;e.$fly.post(o.a.appSave,{product:{id:s[0]},version:l,platform:a,ossUrl:"android"===a?i:null,isProduction:e.path.isProduction}).then(function(r){1e5===r.status?(e.$message({message:"保存成功",type:"success"}),e.$refs.form.resetFields(),e.goBack()):e.$message({message:"保存失败",type:"error"})}).catch(function(){e.$message({message:"请求失败",duration:2e3,type:"error"})})}})})},VersionIsExit:function(){var e=this.form,r=e.product,t=e.platform,s=e.version;return this.$fly.post(o.a.VersionIsExit,{productId:r[0],version:s,platform:t,isProduction:this.path.isProduction})}}},l=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"page"},[t("div",{staticClass:"tools-bar"},[t("div",{staticClass:"left-wrap"},[t("back")],1),e._v(" "),t("div",{staticClass:"button-wrap"},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.save}},[e._v("保存")])],1)]),e._v(" "),t("el-form",{ref:"form",attrs:{model:e.form,"status-icon":"",rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"产品",prop:"product"}},[t("picker",{attrs:{size:"small",span:-1,column:1},model:{value:e.form.product,callback:function(r){e.$set(e.form,"product",r)},expression:"form.product"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"平台",prop:"platform"}},[t("el-select",{attrs:{placeholder:"请选择平台"},model:{value:e.form.platform,callback:function(r){e.$set(e.form,"platform",r)},expression:"form.platform"}},e._l(e.platformData,function(e,r){return t("el-option",{key:r,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),"android"===e.form.platform?t("el-form-item",{attrs:{label:"apk",prop:"ossUrl"}},[t("upload",{attrs:{type:"apk",accept:"application/*",path:e.path.url,CDN:"http://fdapprelease.oss-cn-huhehaote.aliyuncs.com/"},model:{value:e.form.ossUrl,callback:function(r){e.$set(e.form,"ossUrl",r)},expression:"form.ossUrl"}})],1):e._e(),e._v(" "),t("el-form-item",{attrs:{label:"版本号",prop:"version"}},[t("el-col",{attrs:{span:6}},[t("el-input",{model:{value:e.form.version,callback:function(r){e.$set(e.form,"version",r)},expression:"form.version"}})],1)],1)],1)],1)};l._withStripped=!0;var i={render:l,staticRenderFns:[]},n=i;var p=t("VU/8")(a,n,!1,null,null,null);p.options.__file="src/pages/system/app.vue";r.default=p.exports}});
//# sourceMappingURL=23.67ae38da70abb0a57589.js.map