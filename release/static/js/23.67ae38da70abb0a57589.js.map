{"version":3,"sources":["webpack:///src/pages/system/app.vue","webpack:///./src/pages/system/app.vue?0793","webpack:///./src/pages/system/app.vue"],"names":["app","data","form","version","ossUrl","product","platform","isProduction","productData","id","name","platformData","value","label","rules","required","message","trigger","validator","rule","callback","console","log","length","Error","isExit","components","upload","picker","computed","path","url","methods","save","_this","this","$refs","validate","valid","VersionIsExit","then","$message","type","_form","$fly","post","utils","appSave","status","resetFields","goBack","catch","duration","_form2","productId","render","_vm","_h","$createElement","_c","_self","staticClass","_v","attrs","size","on","click","ref","model","status-icon","label-width","prop","span","column","$$v","$set","expression","placeholder","_l","item","index","key","accept","CDN","_e","_withStripped","esExports","staticRenderFns","system_app","Component","__webpack_require__","normalizeComponent","options","__file","__webpack_exports__"],"mappings":"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","file":"static/js/23.67ae38da70abb0a57589.js","sourcesContent":["<template>\r\n  <div class=\"page\">\r\n    <div class=\"tools-bar\">\r\n      <div class=\"left-wrap\">\r\n        <back></back>\r\n      </div>\r\n      <div class=\"button-wrap\">\r\n        <el-button type=\"primary\" size=\"small\" @click=\"save\">保存</el-button>\r\n      </div>\r\n    </div>\r\n    <el-form ref=\"form\" :model=\"form\" status-icon :rules=\"rules\" label-width=\"80px\">\r\n      <!-- <upload v-model='params.picture'></upload> -->\r\n      <el-form-item label=\"产品\" prop=\"product\">\r\n        <picker v-model=\"form.product\" size=\"small\" :span=\"-1\" :column=\"1\"></picker>\r\n      </el-form-item>\r\n      <el-form-item label=\"平台\" prop=\"platform\">\r\n        <el-select v-model=\"form.platform\" placeholder=\"请选择平台\">\r\n          <el-option v-for=\"(item,index) in platformData\" :key=\"index\" :label=\"item.label\" :value=\"item.value\">\r\n          </el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"apk\" prop=\"ossUrl\" v-if=\"form.platform==='android'\">\r\n        <upload v-model=\"form.ossUrl\" type=\"apk\" accept=\"application/*\" :path=\"path.url\" CDN=\"http://fdapprelease.oss-cn-huhehaote.aliyuncs.com/\"></upload>\r\n      </el-form-item>\r\n      <el-form-item label=\"版本号\" prop=\"version\">\r\n        <el-col :span='6'>\r\n          <el-input v-model=\"form.version\"></el-input>\r\n        </el-col>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { api } from '@/utils'\r\nimport { upload, picker } from '@/components'\r\nexport default {\r\n  data () {\r\n    let validatePickerVal = (rule, value, callback) => {\r\n      console.log(value.length)\r\n      if (value.length < 1) {\r\n        callback(new Error('请选择产品'))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    return {\r\n      form: {\r\n        version: '',\r\n        ossUrl: '',\r\n        product: [1],\r\n        platform: 'android',\r\n        isProduction: true\r\n      },\r\n      productData: [{\r\n        id: 1,\r\n        name: '选科'\r\n      }, {\r\n        id: 2,\r\n        name: '志愿'\r\n      }],\r\n      platformData: [{\r\n        value: 'android',\r\n        label: 'android'\r\n      }, {\r\n        value: 'ios',\r\n        label: 'ios'\r\n      }],\r\n      rules: {\r\n        ossUrl: [{ required: true, message: '请上传apk文件', trigger: 'blur' }],\r\n        product: [{ required: true, validator: validatePickerVal, trigger: 'change' }],\r\n        platform: [{ required: true, message: '请选择平台', trigger: 'change' }],\r\n        version: [{ required: true, message: '请输入版本号', trigger: 'blur' }]\r\n      },\r\n      isExit: false\r\n    }\r\n  },\r\n  components: {\r\n    upload,\r\n    picker\r\n  },\r\n  computed: {\r\n    path () {\r\n      let path = {}\r\n      if (process.env.NODE_ENV === 'production') {\r\n        path.url = 'official/android/'\r\n        path.isProduction = true\r\n      } else {\r\n        path.url = 'test/android/'\r\n        path.isProduction = false\r\n      }\r\n      return path\r\n    }\r\n  },\r\n  methods: {\r\n    save () {\r\n      console.log(this.path)\r\n      this.$refs['form'].validate((valid) => {\r\n        if (valid) {\r\n          if (this.form.version !== '') {\r\n            this.VersionIsExit().then(data => {\r\n              if (data.data) {\r\n                this.$message({\r\n                  message: '当前产品的平台下已存在此版本号',\r\n                  type: 'error'\r\n                })\r\n              } else {\r\n                let { product, platform, version, ossUrl } = this.form\r\n                this.$fly.post(api.appSave, {\r\n                  product: { id: product[0] },\r\n                  version,\r\n                  platform,\r\n                  ossUrl: platform === 'android' ? ossUrl : null,\r\n                  isProduction: this.path.isProduction\r\n                }).then(data => {\r\n                  if (data.status === 100000) {\r\n                    this.$message({\r\n                      message: '保存成功',\r\n                      type: 'success'\r\n                    })\r\n                    this.$refs['form'].resetFields()\r\n                    this.goBack()\r\n                  } else {\r\n                    this.$message({\r\n                      message: '保存失败',\r\n                      type: 'error'\r\n                    })\r\n                  }\r\n                }).catch(() => {\r\n                  this.$message({\r\n                    message: '请求失败',\r\n                    duration: 2000,\r\n                    type: 'error'\r\n                  })\r\n                })\r\n              }\r\n            })\r\n          }\r\n        }\r\n      })\r\n    },\r\n    VersionIsExit () {\r\n      let { product, platform, version } = this.form\r\n      return this.$fly.post(api.VersionIsExit, {\r\n        productId: product[0],\r\n        version,\r\n        platform,\r\n        isProduction: this.path.isProduction\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/system/app.vue","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"page\" },\n    [\n      _c(\"div\", { staticClass: \"tools-bar\" }, [\n        _c(\"div\", { staticClass: \"left-wrap\" }, [_c(\"back\")], 1),\n        _vm._v(\" \"),\n        _c(\n          \"div\",\n          { staticClass: \"button-wrap\" },\n          [\n            _c(\n              \"el-button\",\n              {\n                attrs: { type: \"primary\", size: \"small\" },\n                on: { click: _vm.save }\n              },\n              [_vm._v(\"保存\")]\n            )\n          ],\n          1\n        )\n      ]),\n      _vm._v(\" \"),\n      _c(\n        \"el-form\",\n        {\n          ref: \"form\",\n          attrs: {\n            model: _vm.form,\n            \"status-icon\": \"\",\n            rules: _vm.rules,\n            \"label-width\": \"80px\"\n          }\n        },\n        [\n          _c(\n            \"el-form-item\",\n            { attrs: { label: \"产品\", prop: \"product\" } },\n            [\n              _c(\"picker\", {\n                attrs: { size: \"small\", span: -1, column: 1 },\n                model: {\n                  value: _vm.form.product,\n                  callback: function($$v) {\n                    _vm.$set(_vm.form, \"product\", $$v)\n                  },\n                  expression: \"form.product\"\n                }\n              })\n            ],\n            1\n          ),\n          _vm._v(\" \"),\n          _c(\n            \"el-form-item\",\n            { attrs: { label: \"平台\", prop: \"platform\" } },\n            [\n              _c(\n                \"el-select\",\n                {\n                  attrs: { placeholder: \"请选择平台\" },\n                  model: {\n                    value: _vm.form.platform,\n                    callback: function($$v) {\n                      _vm.$set(_vm.form, \"platform\", $$v)\n                    },\n                    expression: \"form.platform\"\n                  }\n                },\n                _vm._l(_vm.platformData, function(item, index) {\n                  return _c(\"el-option\", {\n                    key: index,\n                    attrs: { label: item.label, value: item.value }\n                  })\n                })\n              )\n            ],\n            1\n          ),\n          _vm._v(\" \"),\n          _vm.form.platform === \"android\"\n            ? _c(\n                \"el-form-item\",\n                { attrs: { label: \"apk\", prop: \"ossUrl\" } },\n                [\n                  _c(\"upload\", {\n                    attrs: {\n                      type: \"apk\",\n                      accept: \"application/*\",\n                      path: _vm.path.url,\n                      CDN: \"http://fdapprelease.oss-cn-huhehaote.aliyuncs.com/\"\n                    },\n                    model: {\n                      value: _vm.form.ossUrl,\n                      callback: function($$v) {\n                        _vm.$set(_vm.form, \"ossUrl\", $$v)\n                      },\n                      expression: \"form.ossUrl\"\n                    }\n                  })\n                ],\n                1\n              )\n            : _vm._e(),\n          _vm._v(\" \"),\n          _c(\n            \"el-form-item\",\n            { attrs: { label: \"版本号\", prop: \"version\" } },\n            [\n              _c(\n                \"el-col\",\n                { attrs: { span: 6 } },\n                [\n                  _c(\"el-input\", {\n                    model: {\n                      value: _vm.form.version,\n                      callback: function($$v) {\n                        _vm.$set(_vm.form, \"version\", $$v)\n                      },\n                      expression: \"form.version\"\n                    }\n                  })\n                ],\n                1\n              )\n            ],\n            1\n          )\n        ],\n        1\n      )\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\nif (module.hot) {\n  module.hot.accept()\n  if (module.hot.data) {\n    require(\"vue-hot-reload-api\")      .rerender(\"data-v-04660b45\", esExports)\n  }\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-04660b45\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/system/app.vue\n// module id = null\n// module chunks = ","var disposed = false\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./app.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./app.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-04660b45\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./app.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\nComponent.options.__file = \"src/pages/system/app.vue\"\n\n/* hot reload */\nif (module.hot) {(function () {\n  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), false)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-04660b45\", Component.options)\n  } else {\n    hotAPI.reload(\"data-v-04660b45\", Component.options)\n  }\n  module.hot.dispose(function (data) {\n    disposed = true\n  })\n})()}\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/system/app.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}