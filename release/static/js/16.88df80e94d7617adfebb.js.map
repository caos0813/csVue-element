{"version":3,"sources":["webpack:///src/pages/zhiyuan/banner/add.vue","webpack:///./src/pages/zhiyuan/banner/add.vue?09bd","webpack:///./src/pages/zhiyuan/banner/add.vue"],"names":["add","data","params","title","image","isArticle","pickerVal","content","status","firstData","secondData","threeData","rules","required","message","trigger","type","validator","rule","value","callback","length","Error","timeDialog","addForm","publishTime","pickerOptions2","disabledDate","time","getTime","Date","now","formRules","components","upload","Tinymce","watch","methods","release","this","postData","utils","zhiyuan_bannerPublishNow","timeRelease","_this","$refs","validate","valid","resetFields","submit","zhiyuan_bannerSave","refs","links","_this2","console","log","_params","id","moduleId","$route","query","$fly","post","identification","releaseTime","picture","articleInfoId","then","$message","duration","goBack","catch","save","zhiyuan_bannerPublishDelay","cancel","selectChange","e","isLink","url","firstChange","init","index","lodash","findIndex","item","specialTopicInfoConditionBeans","secondChange","atricleSelectBeanList","getQueryCondition","_this3","get","bannerQueryCondition","productId","isUndefined","created","_this4","zhiyuan_bannerDetail","_data$data","_id","specialTopicInfoId","moduleConditionId","render","_vm","_h","$createElement","_c","_self","staticClass","_v","attrs","size","on","click","ref","model","label-width","label","prop","span","placeholder","maxlength","$$v","$set","expression","path","width","height","change","_l","key","name","visible","close-on-click-modal","update:visible","$event","inline-message","label-suffix","picker-options","slot","_withStripped","esExports","staticRenderFns","banner_add","Component","__webpack_require__","normalizeComponent","options","__file","__webpack_exports__"],"mappings":"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","file":"static/js/16.88df80e94d7617adfebb.js","sourcesContent":["<template>\r\n  <div class=\"page\">\r\n    <div class=\"tools-bar\">\r\n      <div class=\"left-wrap\">\r\n        <back></back>\r\n      </div>\r\n      <div class=\"button-wrap\">\r\n        <el-button type=\"primary\" size=\"small\" @click=\"release\">直接发布</el-button>\r\n        <el-button type=\"info\" size=\"small\" @click=\"timeRelease\">定时发布</el-button>\r\n        <el-button type=\"warning\" size=\"small\" @click=\"submit\">草稿</el-button>\r\n      </div>\r\n    </div>\r\n    <el-form ref=\"form\" :model=\"params\" :rules=\"rules\" label-width=\"80px\">\r\n      <el-form-item label=\"标题\" prop=\"title\">\r\n        <el-col :span='12'>\r\n          <el-input v-model=\"params.title\" placeholder=\"请输入标题\" maxlength=\"20\"></el-input>\r\n        </el-col>\r\n      </el-form-item>\r\n      <el-form-item label=\"封面\" prop=\"image\">\r\n        <upload v-model=\"params.image\" path=\"image/article/\" width=\"735\" height=\"450\"></upload>\r\n      </el-form-item>\r\n      <el-form-item label=\"选择文章\">\r\n        <el-switch v-model=\"params.isArticle\" @change=\"selectChange\"></el-switch>\r\n      </el-form-item>\r\n      <el-form-item v-if='params.isArticle' label=\"选择文章\" :prop=\"params.isArticle?'pickerVal':''\">\r\n        <el-select v-model=\"params.pickerVal[0]\" class=\"mRight_15\" placeholder=\"请选择模块\" @change=\"firstChange\">\r\n          <el-option v-for=\"(item,index) in firstData\" :key=\"index\" :label=\"item.name\" :value=\"item.id\"></el-option>\r\n        </el-select>\r\n        <el-select v-model=\"params.pickerVal[1]\" class=\"mRight_15\" placeholder=\"请选择专题\" @change=\"secondChange\">\r\n          <el-option v-for=\"(item,index) in secondData\" :key=\"index\" :label=\"item.title\" :value=\"item.id\"></el-option>\r\n        </el-select>\r\n        <el-select v-model=\"params.pickerVal[2]\" placeholder=\"请选择文章\">\r\n          <el-option v-for=\"(item,index) in threeData\" :key=\"index\" :label=\"item.title\" :value=\"item.id\"></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item v-else :prop=\"!params.isArticle?'content':''\">\r\n        <el-col :span=\"18\">\r\n          <Tinymce :height=\"600\" ref=\"editor\" v-model=\"params.content\" />\r\n        </el-col>\r\n      </el-form-item>\r\n    </el-form>\r\n    <el-dialog title=\"定时发布\" :visible.sync=\"timeDialog\" width=\"500px\" :close-on-click-modal=\"false\">\r\n      <el-form :model=\"addForm\" inline-message ref=\"addForm\" :rules=\"formRules\" label-suffix=\":\" label-width=\"100\">\r\n        <el-form-item label=\"发布时间\" prop=\"publishTime\">\r\n          <el-col :span='12'>\r\n            <el-date-picker v-model=\"addForm.publishTime\" type=\"datetime\" :picker-options=\"pickerOptions2\" placeholder=\"请选择发布时间\" class=\"full\">\r\n            </el-date-picker>\r\n          </el-col>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"cancel\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"save\">确定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { api } from '@/utils'\r\nimport Tinymce from '@/components/Tinymce'\r\nimport { upload } from '@/components'\r\nexport default {\r\n  data () {\r\n    let validatePickerVal = (rule, value, callback) => {\r\n      if (value.length < 3) {\r\n        callback(new Error('请选择模块、专题和文章'))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    return {\r\n      params: {\r\n        title: '',\r\n        image: '',\r\n        isArticle: true,\r\n        pickerVal: [],\r\n        content: '',\r\n        status: ''\r\n      },\r\n      firstData: [],\r\n      secondData: [],\r\n      threeData: [],\r\n      rules: {\r\n        title: [{ required: true, message: '标题不能为空，且最多输入20个字符', trigger: 'blur' }],\r\n        content: [{ required: true, message: '请输入内容', trigger: 'blur' }],\r\n        image: [{ type: 'string', required: true, message: '封面不能为空，且大小限制于735*450', trigger: 'change' }],\r\n        pickerVal: [{ required: true, validator: validatePickerVal, trigger: 'change' }]\r\n      },\r\n      timeDialog: false,\r\n      addForm: {\r\n        publishTime: ''\r\n      },\r\n      pickerOptions2: {\r\n        disabledDate (time) {\r\n          return time.getTime() < Date.now() - 8.64e7\r\n        }\r\n      },\r\n      formRules: {\r\n        publishTime: [{ type: 'date', required: true, message: '时间不能为空', trigger: 'change' }]\r\n      }\r\n    }\r\n  },\r\n  components: {\r\n    upload,\r\n    Tinymce\r\n  },\r\n  watch: {\r\n    pickerVal () {\r\n\r\n    }\r\n  },\r\n  methods: {\r\n    // 直接发布\r\n    release () {\r\n      this.params.status = 1\r\n      this.postData('form', api.zhiyuan_bannerPublishNow)\r\n    },\r\n    timeRelease () {\r\n      this.$refs['form'].validate((valid) => {\r\n        if (valid) {\r\n          this.timeDialog = true\r\n          if (this.$refs['addForm']) {\r\n            this.$refs['addForm'].resetFields()\r\n          }\r\n        }\r\n      })\r\n    },\r\n    // 保存为草稿\r\n    submit () {\r\n      this.params.status = 2\r\n      this.postData('form', api.zhiyuan_bannerSave)\r\n    },\r\n    postData (refs, links) {\r\n      this.$refs[refs].validate((valid) => {\r\n        if (valid) {\r\n          let { title, image, isArticle, id, content, pickerVal, status } = this.params\r\n          let publishTime = this.timeDialog ? new Date(this.addForm.publishTime).getTime() : null\r\n          let moduleId\r\n          if (this.$route.params.type === 'edit') {\r\n            moduleId = this.params.moduleId\r\n          } else {\r\n            moduleId = this.$route.query.moduleId\r\n          }\r\n          console.log(pickerVal)\r\n          this.$fly.post(links, {\r\n            moduleId: moduleId,\r\n            id,\r\n            title,\r\n            identification: isArticle ? 2 : 1,\r\n            releaseTime: publishTime,\r\n            picture: image,\r\n            content: !isArticle ? content : null,\r\n            articleInfoId: isArticle ? pickerVal[2] : null,\r\n            status: status\r\n          }).then(data => {\r\n            this.$message({\r\n              message: '保存成功',\r\n              duration: 2000,\r\n              type: 'success'\r\n            })\r\n            this.$refs['form'].resetFields()\r\n            this.timeDialog = false\r\n            this.goBack()\r\n          }).catch(() => {\r\n            this.$message({\r\n              message: '保存失败',\r\n              duration: 2000,\r\n              type: 'error'\r\n            })\r\n          })\r\n        } else {\r\n          console.log('error submit!!')\r\n          return false\r\n        }\r\n      })\r\n    },\r\n    // 定时发布\r\n    save () {\r\n      this.params.status = 4\r\n      this.postData('addForm', api.zhiyuan_bannerPublishDelay)\r\n    },\r\n    cancel () {\r\n      this.$refs['addForm'].resetFields()\r\n      this.timeDialog = false\r\n    },\r\n    selectChange (e) {\r\n      this.isLink = e\r\n      if (e) {\r\n        this.params.content = ''\r\n      } else {\r\n        this.params.url = ''\r\n      }\r\n    },\r\n    firstChange (e, init) {\r\n      if (!init) {\r\n        this.params.pickerVal[1] = null\r\n        this.params.pickerVal[2] = null\r\n      }\r\n      let index = this.lodash.findIndex(this.firstData, (item) => (item.id === e))\r\n      this.secondData = this.firstData[index].specialTopicInfoConditionBeans\r\n    },\r\n    secondChange (e) {\r\n      let index = this.lodash.findIndex(this.secondData, (item) => (item.id === e))\r\n      this.threeData = this.secondData[index].atricleSelectBeanList\r\n    },\r\n    getQueryCondition () {\r\n      this.$fly.get(api.bannerQueryCondition, { productId: 3 }).then(data => {\r\n        if (data.status === 100000) {\r\n          this.firstData = data.data\r\n          if (this.params.pickerVal.length) {\r\n            if (!this.lodash.isUndefined(this.params.pickerVal[0])) {\r\n              this.firstChange(this.params.pickerVal[0], true)\r\n              if (!this.lodash.isUndefined(this.params.pickerVal[1])) {\r\n                this.secondChange(this.params.pickerVal[1])\r\n              }\r\n            }\r\n          }\r\n        } else {\r\n          this.$message({\r\n            message: '请求失败',\r\n            duration: 2000,\r\n            type: 'error'\r\n          })\r\n        }\r\n      }).catch(() => {\r\n        this.$message({\r\n          message: '请求失败',\r\n          duration: 2000,\r\n          type: 'error'\r\n        })\r\n      })\r\n    }\r\n  },\r\n  created () {\r\n    let { type } = this.$route.params\r\n    let { id } = this.$route.query\r\n    if (type === 'edit') {\r\n      this.$fly.get(api.zhiyuan_bannerDetail, {\r\n        id\r\n      }).then(data => {\r\n        if (data.status === 100000) {\r\n          let { id, articleInfoId, content, title, identification, picture, moduleId, specialTopicInfoId, moduleConditionId } = data.data\r\n          this.params.id = id\r\n          this.params.title = title\r\n          this.params.content = content\r\n          this.params.moduleId = moduleId\r\n          if (identification === 1) {\r\n            this.params.isArticle = false\r\n          } else {\r\n            this.params.isArticle = true\r\n          }\r\n          this.params.image = picture\r\n          if (identification === 2) {\r\n            this.params.pickerVal[0] = moduleConditionId\r\n            this.params.pickerVal[1] = specialTopicInfoId\r\n            this.params.pickerVal[2] = articleInfoId\r\n          } else {\r\n            this.params.pickerVal = []\r\n          }\r\n          this.getQueryCondition()\r\n        } else {\r\n          this.$message({\r\n            message: '请求失败',\r\n            duration: 2000,\r\n            type: 'error'\r\n          })\r\n        }\r\n      }).catch(() => {\r\n        this.$message({\r\n          message: '请求失败',\r\n          duration: 2000,\r\n          type: 'error'\r\n        })\r\n      })\r\n    } else {\r\n      this.getQueryCondition()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/zhiyuan/banner/add.vue","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"page\" },\n    [\n      _c(\"div\", { staticClass: \"tools-bar\" }, [\n        _c(\"div\", { staticClass: \"left-wrap\" }, [_c(\"back\")], 1),\n        _vm._v(\" \"),\n        _c(\n          \"div\",\n          { staticClass: \"button-wrap\" },\n          [\n            _c(\n              \"el-button\",\n              {\n                attrs: { type: \"primary\", size: \"small\" },\n                on: { click: _vm.release }\n              },\n              [_vm._v(\"直接发布\")]\n            ),\n            _vm._v(\" \"),\n            _c(\n              \"el-button\",\n              {\n                attrs: { type: \"info\", size: \"small\" },\n                on: { click: _vm.timeRelease }\n              },\n              [_vm._v(\"定时发布\")]\n            ),\n            _vm._v(\" \"),\n            _c(\n              \"el-button\",\n              {\n                attrs: { type: \"warning\", size: \"small\" },\n                on: { click: _vm.submit }\n              },\n              [_vm._v(\"草稿\")]\n            )\n          ],\n          1\n        )\n      ]),\n      _vm._v(\" \"),\n      _c(\n        \"el-form\",\n        {\n          ref: \"form\",\n          attrs: { model: _vm.params, rules: _vm.rules, \"label-width\": \"80px\" }\n        },\n        [\n          _c(\n            \"el-form-item\",\n            { attrs: { label: \"标题\", prop: \"title\" } },\n            [\n              _c(\n                \"el-col\",\n                { attrs: { span: 12 } },\n                [\n                  _c(\"el-input\", {\n                    attrs: { placeholder: \"请输入标题\", maxlength: \"20\" },\n                    model: {\n                      value: _vm.params.title,\n                      callback: function($$v) {\n                        _vm.$set(_vm.params, \"title\", $$v)\n                      },\n                      expression: \"params.title\"\n                    }\n                  })\n                ],\n                1\n              )\n            ],\n            1\n          ),\n          _vm._v(\" \"),\n          _c(\n            \"el-form-item\",\n            { attrs: { label: \"封面\", prop: \"image\" } },\n            [\n              _c(\"upload\", {\n                attrs: { path: \"image/article/\", width: \"735\", height: \"450\" },\n                model: {\n                  value: _vm.params.image,\n                  callback: function($$v) {\n                    _vm.$set(_vm.params, \"image\", $$v)\n                  },\n                  expression: \"params.image\"\n                }\n              })\n            ],\n            1\n          ),\n          _vm._v(\" \"),\n          _c(\n            \"el-form-item\",\n            { attrs: { label: \"选择文章\" } },\n            [\n              _c(\"el-switch\", {\n                on: { change: _vm.selectChange },\n                model: {\n                  value: _vm.params.isArticle,\n                  callback: function($$v) {\n                    _vm.$set(_vm.params, \"isArticle\", $$v)\n                  },\n                  expression: \"params.isArticle\"\n                }\n              })\n            ],\n            1\n          ),\n          _vm._v(\" \"),\n          _vm.params.isArticle\n            ? _c(\n                \"el-form-item\",\n                {\n                  attrs: {\n                    label: \"选择文章\",\n                    prop: _vm.params.isArticle ? \"pickerVal\" : \"\"\n                  }\n                },\n                [\n                  _c(\n                    \"el-select\",\n                    {\n                      staticClass: \"mRight_15\",\n                      attrs: { placeholder: \"请选择模块\" },\n                      on: { change: _vm.firstChange },\n                      model: {\n                        value: _vm.params.pickerVal[0],\n                        callback: function($$v) {\n                          _vm.$set(_vm.params.pickerVal, 0, $$v)\n                        },\n                        expression: \"params.pickerVal[0]\"\n                      }\n                    },\n                    _vm._l(_vm.firstData, function(item, index) {\n                      return _c(\"el-option\", {\n                        key: index,\n                        attrs: { label: item.name, value: item.id }\n                      })\n                    })\n                  ),\n                  _vm._v(\" \"),\n                  _c(\n                    \"el-select\",\n                    {\n                      staticClass: \"mRight_15\",\n                      attrs: { placeholder: \"请选择专题\" },\n                      on: { change: _vm.secondChange },\n                      model: {\n                        value: _vm.params.pickerVal[1],\n                        callback: function($$v) {\n                          _vm.$set(_vm.params.pickerVal, 1, $$v)\n                        },\n                        expression: \"params.pickerVal[1]\"\n                      }\n                    },\n                    _vm._l(_vm.secondData, function(item, index) {\n                      return _c(\"el-option\", {\n                        key: index,\n                        attrs: { label: item.title, value: item.id }\n                      })\n                    })\n                  ),\n                  _vm._v(\" \"),\n                  _c(\n                    \"el-select\",\n                    {\n                      attrs: { placeholder: \"请选择文章\" },\n                      model: {\n                        value: _vm.params.pickerVal[2],\n                        callback: function($$v) {\n                          _vm.$set(_vm.params.pickerVal, 2, $$v)\n                        },\n                        expression: \"params.pickerVal[2]\"\n                      }\n                    },\n                    _vm._l(_vm.threeData, function(item, index) {\n                      return _c(\"el-option\", {\n                        key: index,\n                        attrs: { label: item.title, value: item.id }\n                      })\n                    })\n                  )\n                ],\n                1\n              )\n            : _c(\n                \"el-form-item\",\n                { attrs: { prop: !_vm.params.isArticle ? \"content\" : \"\" } },\n                [\n                  _c(\n                    \"el-col\",\n                    { attrs: { span: 18 } },\n                    [\n                      _c(\"Tinymce\", {\n                        ref: \"editor\",\n                        attrs: { height: 600 },\n                        model: {\n                          value: _vm.params.content,\n                          callback: function($$v) {\n                            _vm.$set(_vm.params, \"content\", $$v)\n                          },\n                          expression: \"params.content\"\n                        }\n                      })\n                    ],\n                    1\n                  )\n                ],\n                1\n              )\n        ],\n        1\n      ),\n      _vm._v(\" \"),\n      _c(\n        \"el-dialog\",\n        {\n          attrs: {\n            title: \"定时发布\",\n            visible: _vm.timeDialog,\n            width: \"500px\",\n            \"close-on-click-modal\": false\n          },\n          on: {\n            \"update:visible\": function($event) {\n              _vm.timeDialog = $event\n            }\n          }\n        },\n        [\n          _c(\n            \"el-form\",\n            {\n              ref: \"addForm\",\n              attrs: {\n                model: _vm.addForm,\n                \"inline-message\": \"\",\n                rules: _vm.formRules,\n                \"label-suffix\": \":\",\n                \"label-width\": \"100\"\n              }\n            },\n            [\n              _c(\n                \"el-form-item\",\n                { attrs: { label: \"发布时间\", prop: \"publishTime\" } },\n                [\n                  _c(\n                    \"el-col\",\n                    { attrs: { span: 12 } },\n                    [\n                      _c(\"el-date-picker\", {\n                        staticClass: \"full\",\n                        attrs: {\n                          type: \"datetime\",\n                          \"picker-options\": _vm.pickerOptions2,\n                          placeholder: \"请选择发布时间\"\n                        },\n                        model: {\n                          value: _vm.addForm.publishTime,\n                          callback: function($$v) {\n                            _vm.$set(_vm.addForm, \"publishTime\", $$v)\n                          },\n                          expression: \"addForm.publishTime\"\n                        }\n                      })\n                    ],\n                    1\n                  )\n                ],\n                1\n              )\n            ],\n            1\n          ),\n          _vm._v(\" \"),\n          _c(\n            \"span\",\n            {\n              staticClass: \"dialog-footer\",\n              attrs: { slot: \"footer\" },\n              slot: \"footer\"\n            },\n            [\n              _c(\"el-button\", { on: { click: _vm.cancel } }, [_vm._v(\"取消\")]),\n              _vm._v(\" \"),\n              _c(\n                \"el-button\",\n                { attrs: { type: \"primary\" }, on: { click: _vm.save } },\n                [_vm._v(\"确定\")]\n              )\n            ],\n            1\n          )\n        ],\n        1\n      )\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\nif (module.hot) {\n  module.hot.accept()\n  if (module.hot.data) {\n    require(\"vue-hot-reload-api\")      .rerender(\"data-v-6e78f96d\", esExports)\n  }\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-6e78f96d\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/zhiyuan/banner/add.vue\n// module id = null\n// module chunks = ","var disposed = false\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./add.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./add.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-6e78f96d\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./add.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\nComponent.options.__file = \"src/pages/zhiyuan/banner/add.vue\"\n\n/* hot reload */\nif (module.hot) {(function () {\n  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), false)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-6e78f96d\", Component.options)\n  } else {\n    hotAPI.reload(\"data-v-6e78f96d\", Component.options)\n  }\n  module.hot.dispose(function (data) {\n    disposed = true\n  })\n})()}\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/zhiyuan/banner/add.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}