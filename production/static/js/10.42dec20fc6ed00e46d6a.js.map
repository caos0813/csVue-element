{"version":3,"sources":["webpack:///src/pages/system/user-list.vue","webpack:///./src/pages/system/user-list.vue?5958","webpack:///./src/pages/system/user-list.vue"],"names":["user_list","data","_this","this","params","page","checkData","pageInfo","totalElements","currentPage","tableData","loading","dialogResetPassword","form","oldPassword","newPassword","surePassword","rules","required","validator","rule","value","callback","$fly","post","utils","existPassword","id","userId","then","status","Error","$message","message","type","trigger","test","username","isDeleteShelf","components","listHandle","pagination","methods","handleDelete","_this2","checkIds","Object","item","length","error","push","ids","txt","duration","refresh","catch","filterTag","row","resetPassword","_this3","console","log","$nextTick","$refs","resetFields","cancel","save","_this4","validate","valid","_form","js_cookie_default","a","getJSON","userName","signOut","getData","handleSelectionChange","e","_this5","lodash","map","_this6","setTimeout","remove","$router","replace","name","size","limit","_this7","get","getUsers","_data$data","content","parseInt","created","mounted","pageSizes","system_user_list","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","showSoldout","showDelete","on","click","_v","directives","rawName","expression","ref","header-cell-class-name","element-loading-text","border","stripe","selection-change","width","align","label-class-name","prop","label","min-width","show-overflow-tooltip","scopedSlots","_u","key","fn","scope","department","_s","undefined","filters","text","filter-method","filter-placement","disable-transitions","roles","_f","createTime","to","query","tag","$event","stopPropagation","total","update:page","$set","title","visible","close-on-click-modal","update:visible","model","label-width","label-suffix","$$v","slot","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/10.42dec20fc6ed00e46d6a.js","sourcesContent":["<template>\r\n  <div class=\"page\">\r\n    <div class=\"tools-bar\">\r\n      <listHandle :showSoldout=\"false\" :checkData=\"checkData\" @refresh=\"refresh\" :showDelete=\"false\">\r\n        <el-button type=\"danger\" size=\"small\" @click=\"handleDelete\">禁用</el-button>\r\n      </listHandle>\r\n    </div>\r\n    <el-table ref=\"multipleTable\" header-cell-class-name=\"tableHeader\" :data=\"tableData\" v-loading=\"loading\" element-loading-text=\"拼命加载中\" border stripe @selection-change=\"handleSelectionChange\">\r\n      <el-table-column type=\"selection\" width=\"55\" align=\"center\" label-class-name=\"checkLabel\">\r\n      </el-table-column>\r\n      <el-table-column type=\"index\" width=\"50\" align=\"center\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"nickname\" label=\"昵称\" align=\"center\" min-width=\"150\" show-overflow-tooltip>\r\n      </el-table-column>\r\n      <el-table-column prop=\"username\" label=\"账号\" align=\"center\" min-width=\"150\" show-overflow-tooltip>\r\n      </el-table-column>\r\n      <el-table-column prop=\"phoneNumber\" label=\"手机号\" align=\"center\" width=\"150\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"department\" label=\"部门\" align=\"center\">\r\n        <template slot-scope=\"scope\" v-if=\"scope.row.department\">{{ scope.row.department.name }}</template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"status\" label=\"状态\" width=\"100\" align=\"center\" :filters=\"[{ text: '禁用', value: 'DISABLED' }, { text: '可用', value: 'ENABLED' }]\" :filter-method=\"filterTag\" filter-placement=\"right\">\r\n        <template slot-scope=\"scope\">\r\n          <el-tag :type=\"scope.row.status === 'DISABLED' ? 'danger' : 'success'\" disable-transitions>\r\n            {{scope.row.status === 'DISABLED'?'禁用':'可用'}}\r\n          </el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"角色\" align=\"center\">\r\n        <template slot-scope=\"scope\" v-if=\"scope.row.roles.length===1\">{{ scope.row.roles[0].name }}</template>\r\n      </el-table-column>\r\n      <el-table-column label=\"创建时间\" width=\"180\" align=\"center\">\r\n        <template slot-scope=\"scope\">{{ scope.row.createTime | dateTime('yyyy-MM-dd hh:mm:ss') }}</template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"remark\" label=\"备注\" min-width=\"200\" show-overflow-tooltip align=\"center\">\r\n      </el-table-column>\r\n      <el-table-column label=\"操作\" width=\"120\" align=\"center\">\r\n        <template slot-scope=\"scope \">\r\n          <el-button type=\"text \" size=\"mini\">\r\n            <router-link :to=\"{name:'system/user',params:{type:'edit'},query:{id:scope.row.id}}\" tag=\"span\">编辑</router-link>\r\n          </el-button>\r\n          <el-button type=\"text\" size=\"mini\" @click.stop=\"resetPassword(scope.row)\">重置密码</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <pagination ref=\"pageInfo\" :total=\"pageInfo.totalElements\" :page.sync=\"pageInfo.currentPage\" @pagination=\"pagination\"></pagination>\r\n    <el-dialog title=\"重置密码\" :visible.sync=\"dialogResetPassword\" :close-on-click-modal=\"false\">\r\n      <el-form :model=\"form\" :rules=\"rules\" ref=\"form\" label-width=\"100px\" label-suffix=\":\">\r\n        <el-form-item label=\"旧密码\" prop=\"oldPassword\">\r\n          <el-input type=\"password\" v-model=\"form.oldPassword\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"新密码\" prop=\"newPassword\">\r\n          <el-input type=\"password\" v-model=\"form.newPassword\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"确认密码\" prop=\"surePassword\">\r\n          <el-input type=\"password\" v-model=\"form.surePassword\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click.stop=\"cancel\">取 消</el-button>\r\n        <el-button type=\"primary\" @click.stop=\"save\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { api, confirm } from '@/utils'\r\nimport { listHandle, pagination } from '@/components'\r\nimport Cookies from 'js-cookie'\r\nexport default {\r\n  data () {\r\n    let validateOldPassword = (rule, value, callback) => {\r\n      if (!value) {\r\n        callback(new Error('请输入旧密码'))\r\n      } else {\r\n        this.$fly.post(api.existPassword, { id: this.userId, oldPassword: value }).then(data => {\r\n          if (data.status === 100000) {\r\n            if (!data.data) {\r\n              callback(new Error('旧密码错误'))\r\n            } else {\r\n              callback()\r\n            }\r\n          } else {\r\n            this.$message({\r\n              message: '请求错误',\r\n              type: 'error'\r\n            })\r\n          }\r\n        })\r\n      }\r\n    }\r\n    let validateNewPassword = (rule, value, callback) => {\r\n      if (!value) {\r\n        callback(new Error('请输入新密码'))\r\n      } else {\r\n        if (!(/^[0-9a-zA_Z]+$/).test(value)) {\r\n          callback(new Error('密码只能是英文字母或数字'))\r\n        } else {\r\n          if (this.form.oldPassword === value) {\r\n            callback(new Error('两次密码不能一致'))\r\n          } else {\r\n            callback()\r\n          }\r\n        }\r\n      }\r\n    }\r\n    let validateSurePassword = (rule, value, callback) => {\r\n      if (!value) {\r\n        callback(new Error('请输入确认密码'))\r\n      } else {\r\n        if (value !== this.form.newPassword) {\r\n          callback(new Error('密码不一致'))\r\n        } else {\r\n          callback()\r\n        }\r\n      }\r\n    }\r\n    return {\r\n      params: {\r\n        page: 1\r\n      },\r\n      checkData: [],\r\n      pageInfo: {\r\n        totalElements: 0,\r\n        currentPage: 1\r\n      },\r\n      tableData: [],\r\n      loading: false,\r\n      dialogResetPassword: false,\r\n      form: {\r\n        oldPassword: null,\r\n        newPassword: null,\r\n        surePassword: ''\r\n      },\r\n      rules: {\r\n        oldPassword: [{ required: true, validator: validateOldPassword, trigger: 'blur' }],\r\n        newPassword: [{ required: true, validator: validateNewPassword, trigger: 'blur' }],\r\n        surePassword: [{ required: true, validator: validateSurePassword, trigger: 'blur' }]\r\n      },\r\n      userId: '',\r\n      username: '',\r\n      isDeleteShelf: false\r\n    }\r\n  },\r\n  components: {\r\n    listHandle,\r\n    pagination\r\n  },\r\n  methods: {\r\n    handleDelete () {\r\n      let txt = '禁用'\r\n      this.checkIds = []\r\n      confirm(`您确定将选择的用户${txt}吗？`, '提示').then(() => {\r\n        for (let item = 0; item < this.checkData.length; item++) {\r\n          if (this.checkData[item].status === 'DISABLED') {\r\n            this.$message.error(`已禁用的用户不能${txt}`)\r\n            this.checkIds = []\r\n            return\r\n          } else {\r\n            this.checkIds.push(this.checkData[item].id)\r\n          }\r\n        }\r\n        if (this.checkIds.length > 0) {\r\n          this.$fly.post(api['system/userDelete'], { ids: this.checkIds, status: 'disabled' }).then(data => {\r\n            if (data.status !== 100000) {\r\n              return this.$message({\r\n                message: `${txt}失败`,\r\n                duration: 2000,\r\n                type: 'error'\r\n              })\r\n            } else {\r\n              this.$message({\r\n                message: `${txt}成功`,\r\n                duration: 2000,\r\n                type: 'success'\r\n              })\r\n              this.refresh()\r\n            }\r\n          }).catch(() => {\r\n            this.$message({\r\n              message: `${txt}失败`,\r\n              duration: 2000,\r\n              type: 'error'\r\n            })\r\n          })\r\n        }\r\n      })\r\n    },\r\n    filterTag (value, row) {\r\n      return row.status === value\r\n    },\r\n    resetPassword (row) {\r\n      console.log(row)\r\n      this.userId = row.id\r\n      this.username = row.username\r\n      this.dialogResetPassword = true\r\n      this.$nextTick(() => {\r\n        this.$refs['form'].resetFields()\r\n      })\r\n    },\r\n    cancel () {\r\n      this.$refs['form'].resetFields()\r\n      this.dialogResetPassword = false\r\n    },\r\n    save () {\r\n      this.$refs['form'].validate((valid) => {\r\n        if (valid) {\r\n          let { oldPassword, newPassword } = this.form\r\n          this.$fly.post(api.resetPassword, { id: this.userId, oldPassword, newPassword }).then(data => {\r\n            if (data.status === 100000) {\r\n              this.$refs['form'].resetFields()\r\n              this.dialogResetPassword = false\r\n              this.$message({\r\n                message: '重置密码成功',\r\n                type: 'success'\r\n              })\r\n              if (this.username === Cookies.getJSON('user').userName) {\r\n                this.signOut('您重置了当前用户的密码，请重新登录')\r\n              }\r\n            } else {\r\n              this.$message({\r\n                message: '重置密码失败',\r\n                type: 'error'\r\n              })\r\n            }\r\n          })\r\n        }\r\n      })\r\n    },\r\n    refresh () {\r\n      this.params.page = 1\r\n      if (this.isDeleteShelf) {\r\n        this.signOut('您删除了当前用户，请重新登录')\r\n      } else {\r\n        this.getData(this.params)\r\n      }\r\n    },\r\n    handleSelectionChange (e) {\r\n      this.checkData = []\r\n      this.lodash.map(e, (item) => {\r\n        this.checkData.push({ id: item.id, status: item.status })\r\n        if (item.username === Cookies.getJSON('user').userName) {\r\n          this.isDeleteShelf = true\r\n        }\r\n      })\r\n    },\r\n    signOut (txt) {\r\n      this.$message({\r\n        message: `${txt}`,\r\n        type: 'warning'\r\n      })\r\n      setTimeout(() => {\r\n        Cookies.remove('user')\r\n        this.$router.replace({\r\n          name: 'login'\r\n        })\r\n      }, 500)\r\n    },\r\n    // 分页\r\n    pagination (e) {\r\n      this.params.page = e.page\r\n      this.params.size = e.limit\r\n      this.getData(this.params)\r\n    },\r\n    // 获取数据\r\n    getData (params) {\r\n      params.page--\r\n      this.loading = true\r\n      this.$fly.get(api.getUsers, params).then(data => {\r\n        setTimeout(() => {\r\n          this.loading = false\r\n        }, 1000)\r\n        let { content, totalElements } = data.data\r\n        this.tableData = content\r\n        this.pageInfo = {\r\n          totalElements: parseInt(totalElements),\r\n          currentPage: params.page + 1\r\n        }\r\n      })\r\n    }\r\n  },\r\n  created () {\r\n    this.getData(this.params)\r\n  },\r\n  mounted () {\r\n    this.params.size = this.$refs.pageInfo.pageSizes[0]\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.tools-bar {\r\n  justify-content: flex-end;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/system/user-list.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page\"},[_c('div',{staticClass:\"tools-bar\"},[_c('listHandle',{attrs:{\"showSoldout\":false,\"checkData\":_vm.checkData,\"showDelete\":false},on:{\"refresh\":_vm.refresh}},[_c('el-button',{attrs:{\"type\":\"danger\",\"size\":\"small\"},on:{\"click\":_vm.handleDelete}},[_vm._v(\"禁用\")])],1)],1),_vm._v(\" \"),_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],ref:\"multipleTable\",attrs:{\"header-cell-class-name\":\"tableHeader\",\"data\":_vm.tableData,\"element-loading-text\":\"拼命加载中\",\"border\":\"\",\"stripe\":\"\"},on:{\"selection-change\":_vm.handleSelectionChange}},[_c('el-table-column',{attrs:{\"type\":\"selection\",\"width\":\"55\",\"align\":\"center\",\"label-class-name\":\"checkLabel\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"type\":\"index\",\"width\":\"50\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"nickname\",\"label\":\"昵称\",\"align\":\"center\",\"min-width\":\"150\",\"show-overflow-tooltip\":\"\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"username\",\"label\":\"账号\",\"align\":\"center\",\"min-width\":\"150\",\"show-overflow-tooltip\":\"\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"phoneNumber\",\"label\":\"手机号\",\"align\":\"center\",\"width\":\"150\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"department\",\"label\":\"部门\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return scope.row.department?[_vm._v(_vm._s(scope.row.department.name))]:undefined}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"status\",\"label\":\"状态\",\"width\":\"100\",\"align\":\"center\",\"filters\":[{ text: '禁用', value: 'DISABLED' }, { text: '可用', value: 'ENABLED' }],\"filter-method\":_vm.filterTag,\"filter-placement\":\"right\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-tag',{attrs:{\"type\":scope.row.status === 'DISABLED' ? 'danger' : 'success',\"disable-transitions\":\"\"}},[_vm._v(\"\\n          \"+_vm._s(scope.row.status === 'DISABLED'?'禁用':'可用')+\"\\n        \")])]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"角色\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return scope.row.roles.length===1?[_vm._v(_vm._s(scope.row.roles[0].name))]:undefined}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"创建时间\",\"width\":\"180\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(_vm._s(_vm._f(\"dateTime\")(scope.row.createTime,'yyyy-MM-dd hh:mm:ss')))]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"remark\",\"label\":\"备注\",\"min-width\":\"200\",\"show-overflow-tooltip\":\"\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"120\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope ){return [_c('el-button',{attrs:{\"type\":\"text \",\"size\":\"mini\"}},[_c('router-link',{attrs:{\"to\":{name:'system/user',params:{type:'edit'},query:{id:scope.row.id}},\"tag\":\"span\"}},[_vm._v(\"编辑\")])],1),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"text\",\"size\":\"mini\"},on:{\"click\":function($event){$event.stopPropagation();_vm.resetPassword(scope.row)}}},[_vm._v(\"重置密码\")])]}}])})],1),_vm._v(\" \"),_c('pagination',{ref:\"pageInfo\",attrs:{\"total\":_vm.pageInfo.totalElements,\"page\":_vm.pageInfo.currentPage},on:{\"update:page\":function($event){_vm.$set(_vm.pageInfo, \"currentPage\", $event)},\"pagination\":_vm.pagination}}),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":\"重置密码\",\"visible\":_vm.dialogResetPassword,\"close-on-click-modal\":false},on:{\"update:visible\":function($event){_vm.dialogResetPassword=$event}}},[_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.form,\"rules\":_vm.rules,\"label-width\":\"100px\",\"label-suffix\":\":\"}},[_c('el-form-item',{attrs:{\"label\":\"旧密码\",\"prop\":\"oldPassword\"}},[_c('el-input',{attrs:{\"type\":\"password\"},model:{value:(_vm.form.oldPassword),callback:function ($$v) {_vm.$set(_vm.form, \"oldPassword\", $$v)},expression:\"form.oldPassword\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"新密码\",\"prop\":\"newPassword\"}},[_c('el-input',{attrs:{\"type\":\"password\"},model:{value:(_vm.form.newPassword),callback:function ($$v) {_vm.$set(_vm.form, \"newPassword\", $$v)},expression:\"form.newPassword\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"确认密码\",\"prop\":\"surePassword\"}},[_c('el-input',{attrs:{\"type\":\"password\"},model:{value:(_vm.form.surePassword),callback:function ($$v) {_vm.$set(_vm.form, \"surePassword\", $$v)},expression:\"form.surePassword\"}})],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){$event.stopPropagation();return _vm.cancel($event)}}},[_vm._v(\"取 消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){$event.stopPropagation();return _vm.save($event)}}},[_vm._v(\"确 定\")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-39a9be60\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/system/user-list.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-39a9be60\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!sass-resources-loader?{\\\"resources\\\":\\\"D:\\\\\\\\work\\\\\\\\junyang_admin\\\\\\\\src\\\\\\\\assets\\\\\\\\sass\\\\\\\\var.scss\\\"}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./user-list.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./user-list.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./user-list.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-39a9be60\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./user-list.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-39a9be60\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/system/user-list.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}