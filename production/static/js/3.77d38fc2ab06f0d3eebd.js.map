{"version":3,"sources":["webpack:///src/pages/xuanke/topic/add.vue","webpack:///./src/pages/xuanke/topic/add.vue?6d1b","webpack:///./src/pages/xuanke/topic/add.vue"],"names":["add","data","_this","this","rules","title","required","message","trigger","content","pickerVal","validator","rule","value","callback","length","Error","vote","console","log","optionData","params","isHot","type","mode","timeDialog","addForm","publishTime","pickerOptions2","disabledDate","time","getTime","Date","now","formRules","components","Tinymce","picker","methods","modeChange","e","release","postData","utils","gambitPublishNow","timeRelease","_this2","$refs","validate","valid","resetFields","save","gambitPublishDelay","cancel","submit","topicHandle","refs","link","status","_this3","_params","id","votes","lodash","isArray","$message","duration","$fly","post","productId","then","goBack","catch","addRow","push","voteContent","delRow","_this4","$index","$route","topicDeleteVote","row","splice","moveRow","cacheObj","created","_this5","query","get","topicDetail","product","topic_add","render","_vm","_h","$createElement","_c","_self","staticClass","_v","attrs","size","on","click","ref","model","label-width","label","prop","$$v","$set","expression","span","placeholder","change","true-label","false-label","border","show-header","align","width","scopedSlots","_u","key","fn","scope","icon","circle","disabled","$event","_e","height","visible","close-on-click-modal","update:visible","inline-message","label-suffix","picker-options","slot","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/3.77d38fc2ab06f0d3eebd.js","sourcesContent":["<template>\r\n  <div class=\"page\">\r\n    <div class=\"tools-bar\">\r\n      <div class=\"left-wrap\">\r\n        <back></back>\r\n      </div>\r\n      <div class=\"button-wrap\">\r\n        <el-button type=\"primary\" size=\"small\" @click=\"release\">直接发布</el-button>\r\n        <el-button type=\"info\" size=\"small\" @click=\"timeRelease\">定时发布</el-button>\r\n        <el-button type=\"warning\" size=\"small\" @click=\"submit\">草稿</el-button>\r\n      </div>\r\n    </div>\r\n    <el-form ref=\"form\" :model=\"params\" :rules=\"rules\" label-width=\"80px\">\r\n      <el-form-item label=\"产品\" prop=\"pickerVal\">\r\n        <picker v-model=\"params.pickerVal\"></picker>\r\n      </el-form-item>\r\n      <el-form-item label=\"类型\">\r\n        <el-col :span=\"6\">\r\n          <el-select v-model=\"mode\" placeholder=\"\" class=\"full\" @change=\"modeChange\">\r\n            <el-option value=\"general\" label=\"普通话题\"></el-option>\r\n            <el-option value=\"vote\" label=\"投票\"></el-option>\r\n          </el-select>\r\n        </el-col>\r\n      </el-form-item>\r\n      <el-form-item label=\"标题\" prop=\"title\">\r\n        <el-col :span='12'>\r\n          <el-input v-model=\"params.title\"></el-input>\r\n        </el-col>\r\n        <el-col :span='4'>\r\n          <el-form-item label-width=\"20px\" prop=\"isHot\">\r\n            <template>\r\n              <el-checkbox v-model=\"params.isHot\" :true-label='1' :false-label='0'>是否热门</el-checkbox>\r\n            </template>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-form-item>\r\n      <el-form-item v-if=\"mode==='vote'\" prop=\"vote\">\r\n        <el-form-item>\r\n          <el-button type=\"info\" size=\"small\" @click=\"addRow\">添加选项</el-button>\r\n          <div class=\"radio-wrap\">\r\n            <el-radio-group v-model=\"params.type\">\r\n              <el-radio :label=\"1\">单选</el-radio>\r\n              <el-radio :label=\"2\">多选</el-radio>\r\n            </el-radio-group>\r\n          </div>\r\n        </el-form-item>\r\n        <div class=\"space\"></div>\r\n        <el-col :span=\"18\">\r\n          <el-table :data=\"optionData\" border :show-header=\"false\">\r\n            <el-table-column label=\"索引\" align=\"center\" type=\"index\" width=\"150px\"></el-table-column>\r\n            <el-table-column label=\"内容\" align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <el-input v-model=\"scope.row.voteContent\" placeholder=\"\"></el-input>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"操作\" align=\"center\" width=\"200px\">\r\n              <template slot-scope=\"scope\">\r\n                <el-button icon=\"el-icon-arrow-up\" circle size=\"small\" title=\"上移\" @click=\"moveRow(scope,'up')\" :disabled=\"scope.$index===0\"></el-button><!-- v-if=\"scope.$index!==0\" -->\r\n                <el-button icon=\"el-icon-arrow-down\" circle size=\"small\" title=\"下移\" @click=\"moveRow(scope,'down')\" :disabled=\"scope.$index==optionData.length-1\"></el-button><!-- v-if=\"scope.$index!==optionData.length-1\" -->\r\n                <el-button type=\"danger\" size=\"small\" @click=\"delRow(scope)\" icon=\"el-icon-delete\" circle></el-button>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </el-col>\r\n      </el-form-item>\r\n      <el-form-item prop=\"content\">\r\n        <el-col :span=\"18\">\r\n          <Tinymce :height=\"600\" ref=\"editor\" v-model=\"params.content\" />\r\n        </el-col>\r\n      </el-form-item>\r\n    </el-form>\r\n    <el-dialog title=\"定时发布\" :visible.sync=\"timeDialog\" width=\"500px\" :close-on-click-modal=\"false\">\r\n      <el-form :model=\"addForm\" inline-message ref=\"addForm\" :rules=\"formRules\" label-suffix=\":\" label-width=\"100\">\r\n        <el-form-item label=\"发布时间\" prop=\"publishTime\">\r\n          <el-col :span='12'>\r\n            <el-date-picker v-model=\"addForm.publishTime\" :picker-options=\"pickerOptions2\" type=\"datetime\" placeholder=\"请选择发布时间\" class=\"full\">\r\n            </el-date-picker>\r\n          </el-col>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"cancel\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"save\">确定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport Tinymce from '@/components/Tinymce'\r\nimport { api } from '@/utils'\r\nimport { picker } from '@/components'\r\nexport default {\r\n  data () {\r\n    let validatePickerVal = (rule, value, callback) => {\r\n      if (value.length < 1) {\r\n        callback(new Error('请选择产品分类和专题'))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    let validateVoteVal = (rule, value, callback) => {\r\n      console.log(value)\r\n      if (this.optionData.length < 1) {\r\n        callback(new Error('请添加选项'))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    return {\r\n      rules: {\r\n        title: [{ required: true, message: '请输入专题名称', trigger: 'blur' }],\r\n        content: [{ required: true, message: '请输入内容', trigger: 'blur' }],\r\n        pickerVal: [{ required: true, validator: validatePickerVal, trigger: 'change' }],\r\n        vote: [{ required: true, validator: validateVoteVal, trigger: 'change' }]\r\n      },\r\n      params: {\r\n        title: '',\r\n        isHot: 0,\r\n        type: 0,\r\n        pickerVal: []\r\n      },\r\n      optionData: [],\r\n      mode: 'general',\r\n      timeDialog: false,\r\n      addForm: {\r\n        publishTime: ''\r\n      },\r\n      pickerOptions2: {\r\n        disabledDate (time) {\r\n          return time.getTime() < Date.now() - 8.64e7\r\n        }\r\n      },\r\n      formRules: {\r\n        publishTime: [{ type: 'date', required: true, message: '时间不能为空', trigger: 'change' }]\r\n      }\r\n    }\r\n  },\r\n  components: {\r\n    Tinymce,\r\n    picker\r\n  },\r\n  methods: {\r\n    modeChange (e) {\r\n      if (e === 'general') {\r\n        this.params.type = 0\r\n      } else {\r\n        if (!this.params.type) {\r\n          this.params.type = 1\r\n        }\r\n      }\r\n    },\r\n    // 立即发布\r\n    release () {\r\n      this.postData('form', api.gambitPublishNow, 1)\r\n    },\r\n    timeRelease () {\r\n      this.$refs['form'].validate((valid) => {\r\n        if (valid) {\r\n          this.timeDialog = true\r\n          if (this.$refs['addForm']) {\r\n            this.$refs['addForm'].resetFields()\r\n          }\r\n        } else {\r\n          console.log('error submit!!')\r\n          return false\r\n        }\r\n      })\r\n    },\r\n    // 定时发布\r\n    save () {\r\n      this.postData('addForm', api.gambitPublishDelay, 4)\r\n    },\r\n    cancel () {\r\n      this.$refs['addForm'].resetFields()\r\n      this.timeDialog = false\r\n    },\r\n    submit () {\r\n      this.postData('form', api.topicHandle, 2)\r\n    },\r\n    postData (refs, link, status) {\r\n      this.$refs[refs].validate((valid) => {\r\n        if (valid) {\r\n          let { title, isHot, pickerVal, type, id, content } = this.params\r\n          let votes = this.mode === 'vote' ? this.optionData : null\r\n          let publishTime = this.timeDialog ? new Date(this.addForm.publishTime).getTime() : null\r\n          if (this.lodash.isArray(votes) && votes.length < 1) {\r\n            this.$message({\r\n              message: '请添加选项',\r\n              duration: 2000,\r\n              type: 'error'\r\n            })\r\n            return\r\n          }\r\n          console.log(title, isHot, pickerVal, type, id, content, publishTime)\r\n          this.$fly.post(link, {\r\n            id,\r\n            title,\r\n            isHot,\r\n            publishTime: publishTime,\r\n            content,\r\n            type,\r\n            votes,\r\n            productId: pickerVal[0],\r\n            status: status\r\n          }).then(data => {\r\n            this.$message({\r\n              message: '保存成功',\r\n              duration: 2000,\r\n              type: 'success'\r\n            })\r\n            this.$refs['form'].resetFields()\r\n            this.timeDialog = false\r\n            this.goBack()\r\n          }).catch(() => {\r\n            this.$message({\r\n              message: '保存失败',\r\n              duration: 2000,\r\n              type: 'error'\r\n            })\r\n          })\r\n        } else {\r\n          console.log('error submit!!')\r\n          return false\r\n        }\r\n      })\r\n    },\r\n    addRow () {\r\n      this.optionData.push({ voteContent: '' })\r\n    },\r\n    delRow (e) {\r\n      console.log(e)\r\n      let { $index } = e\r\n      let { type } = this.$route.params\r\n      if (type === 'edit') {\r\n        this.$fly.post(api.topicDeleteVote, {\r\n          id: e.row.id\r\n        }).then(data => {\r\n          this.optionData.splice($index, 1)\r\n        }).catch(() => {\r\n          this.$message({\r\n            message: '删除失败',\r\n            duration: 2000,\r\n            type: 'error'\r\n          })\r\n        })\r\n      } else {\r\n        this.optionData.splice($index, 1)\r\n      }\r\n    },\r\n    moveRow (e, type) {\r\n      let { $index } = e\r\n      let cacheObj = this.optionData[$index]\r\n      if (type === 'up') {\r\n        this.optionData.splice($index, 1)\r\n        this.optionData.splice($index - 1, 0, cacheObj)\r\n      } else {\r\n        this.optionData.splice($index, 1)\r\n        this.optionData.splice($index + 1, 0, cacheObj)\r\n      }\r\n    }\r\n  },\r\n  created () {\r\n    let { type } = this.$route.params\r\n    let { id } = this.$route.query\r\n    if (type === 'edit') {\r\n      this.$fly.get(api.topicDetail, {\r\n        id\r\n      }).then(data => {\r\n        this.params = data\r\n        this.optionData = data.votes\r\n        this.params.pickerVal = [data.product.id]\r\n        if (data.type === 1 || data.type === 2) {\r\n          this.mode = 'vote'\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.radio-wrap {\r\n  display: inline-block;\r\n  padding-left: 15px;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/xuanke/topic/add.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page\"},[_c('div',{staticClass:\"tools-bar\"},[_c('div',{staticClass:\"left-wrap\"},[_c('back')],1),_vm._v(\" \"),_c('div',{staticClass:\"button-wrap\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":_vm.release}},[_vm._v(\"直接发布\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"info\",\"size\":\"small\"},on:{\"click\":_vm.timeRelease}},[_vm._v(\"定时发布\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"warning\",\"size\":\"small\"},on:{\"click\":_vm.submit}},[_vm._v(\"草稿\")])],1)]),_vm._v(\" \"),_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.params,\"rules\":_vm.rules,\"label-width\":\"80px\"}},[_c('el-form-item',{attrs:{\"label\":\"产品\",\"prop\":\"pickerVal\"}},[_c('picker',{model:{value:(_vm.params.pickerVal),callback:function ($$v) {_vm.$set(_vm.params, \"pickerVal\", $$v)},expression:\"params.pickerVal\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"类型\"}},[_c('el-col',{attrs:{\"span\":6}},[_c('el-select',{staticClass:\"full\",attrs:{\"placeholder\":\"\"},on:{\"change\":_vm.modeChange},model:{value:(_vm.mode),callback:function ($$v) {_vm.mode=$$v},expression:\"mode\"}},[_c('el-option',{attrs:{\"value\":\"general\",\"label\":\"普通话题\"}}),_vm._v(\" \"),_c('el-option',{attrs:{\"value\":\"vote\",\"label\":\"投票\"}})],1)],1)],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"标题\",\"prop\":\"title\"}},[_c('el-col',{attrs:{\"span\":12}},[_c('el-input',{model:{value:(_vm.params.title),callback:function ($$v) {_vm.$set(_vm.params, \"title\", $$v)},expression:\"params.title\"}})],1),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":4}},[_c('el-form-item',{attrs:{\"label-width\":\"20px\",\"prop\":\"isHot\"}},[[_c('el-checkbox',{attrs:{\"true-label\":1,\"false-label\":0},model:{value:(_vm.params.isHot),callback:function ($$v) {_vm.$set(_vm.params, \"isHot\", $$v)},expression:\"params.isHot\"}},[_vm._v(\"是否热门\")])]],2)],1)],1),_vm._v(\" \"),(_vm.mode==='vote')?_c('el-form-item',{attrs:{\"prop\":\"vote\"}},[_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"info\",\"size\":\"small\"},on:{\"click\":_vm.addRow}},[_vm._v(\"添加选项\")]),_vm._v(\" \"),_c('div',{staticClass:\"radio-wrap\"},[_c('el-radio-group',{model:{value:(_vm.params.type),callback:function ($$v) {_vm.$set(_vm.params, \"type\", $$v)},expression:\"params.type\"}},[_c('el-radio',{attrs:{\"label\":1}},[_vm._v(\"单选\")]),_vm._v(\" \"),_c('el-radio',{attrs:{\"label\":2}},[_vm._v(\"多选\")])],1)],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"space\"}),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":18}},[_c('el-table',{attrs:{\"data\":_vm.optionData,\"border\":\"\",\"show-header\":false}},[_c('el-table-column',{attrs:{\"label\":\"索引\",\"align\":\"center\",\"type\":\"index\",\"width\":\"150px\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"内容\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-input',{attrs:{\"placeholder\":\"\"},model:{value:(scope.row.voteContent),callback:function ($$v) {_vm.$set(scope.row, \"voteContent\", $$v)},expression:\"scope.row.voteContent\"}})]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"操作\",\"align\":\"center\",\"width\":\"200px\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"icon\":\"el-icon-arrow-up\",\"circle\":\"\",\"size\":\"small\",\"title\":\"上移\",\"disabled\":scope.$index===0},on:{\"click\":function($event){_vm.moveRow(scope,'up')}}}),_vm._v(\" \"),_c('el-button',{attrs:{\"icon\":\"el-icon-arrow-down\",\"circle\":\"\",\"size\":\"small\",\"title\":\"下移\",\"disabled\":scope.$index==_vm.optionData.length-1},on:{\"click\":function($event){_vm.moveRow(scope,'down')}}}),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"danger\",\"size\":\"small\",\"icon\":\"el-icon-delete\",\"circle\":\"\"},on:{\"click\":function($event){_vm.delRow(scope)}}})]}}])})],1)],1)],1):_vm._e(),_vm._v(\" \"),_c('el-form-item',{attrs:{\"prop\":\"content\"}},[_c('el-col',{attrs:{\"span\":18}},[_c('Tinymce',{ref:\"editor\",attrs:{\"height\":600},model:{value:(_vm.params.content),callback:function ($$v) {_vm.$set(_vm.params, \"content\", $$v)},expression:\"params.content\"}})],1)],1)],1),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":\"定时发布\",\"visible\":_vm.timeDialog,\"width\":\"500px\",\"close-on-click-modal\":false},on:{\"update:visible\":function($event){_vm.timeDialog=$event}}},[_c('el-form',{ref:\"addForm\",attrs:{\"model\":_vm.addForm,\"inline-message\":\"\",\"rules\":_vm.formRules,\"label-suffix\":\":\",\"label-width\":\"100\"}},[_c('el-form-item',{attrs:{\"label\":\"发布时间\",\"prop\":\"publishTime\"}},[_c('el-col',{attrs:{\"span\":12}},[_c('el-date-picker',{staticClass:\"full\",attrs:{\"picker-options\":_vm.pickerOptions2,\"type\":\"datetime\",\"placeholder\":\"请选择发布时间\"},model:{value:(_vm.addForm.publishTime),callback:function ($$v) {_vm.$set(_vm.addForm, \"publishTime\", $$v)},expression:\"addForm.publishTime\"}})],1)],1)],1),_vm._v(\" \"),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":_vm.cancel}},[_vm._v(\"取消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.save}},[_vm._v(\"确定\")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-71c0e61e\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/xuanke/topic/add.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-71c0e61e\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!sass-resources-loader?{\\\"resources\\\":\\\"D:\\\\\\\\work\\\\\\\\junyang_admin\\\\\\\\src\\\\\\\\assets\\\\\\\\sass\\\\\\\\var.scss\\\"}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./add.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./add.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./add.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-71c0e61e\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./add.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-71c0e61e\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/xuanke/topic/add.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}