webpackJsonp([0],{QAaw:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("0xDb"),n=a("bGai"),r={data:function(){return{params:{page:1},checkData:[],pageInfo:{totalElements:0,currentPage:1},tableData:[],loading:!1,form:{phoneNumber:""},rules:{phoneNumber:[{required:!0,trigger:"blur",validator:function(e,t,a){if(!t)return a(new Error("手机号不能为空"));/^1[34578]\d{9}$/.test(t)?a():a(new Error("请输入正确的手机号码"))}}]},isAdd:!1}},components:{listHandle:n.c,pagination:n.d},methods:{append:function(){var e=this;if(this.isAdd)this.$message.error("有超级用户未保存");else{var t={id:"",phoneNumber:this.phoneNumber,createTime:null,isEdit:!0,createUser:{name:null}};this.tableData.push(t),this.isAdd=!0,this.$nextTick(function(){e.$refs.phoneNumberRef.focus()})}},remove:function(){var e=this;if(this.isAdd)this.$message.error("有超级用户未保存");else if(this.checkData.length>0){for(var t=[],a=0;a<this.checkData.length;a++)t.push(this.checkData[a].id);Object(s.b)("您确定删除选中的超级用户吗？","提示").then(function(){t.length>0&&e.$fly.post(s.a.superUserDelete,t).then(function(t){1e5===t.status?(e.$message({message:"删除成功",duration:2e3,type:"success"}),e.params.page=1,e.getData(e.params)):e.$message({message:"删除失败",type:"error"})}).catch(function(){e.$message({message:"删除失败",duration:2e3,type:"error"})})})}else this.$message.error("请先选择需要删除的超级用户")},save:function(e,t){var a=this;this.$refs.form.validate(function(t){t&&a.$fly.post(s.a.superUserSave,{phoneNumber:a.form.phoneNumber}).then(function(t){1e5===t.status?(a.$message({message:"保存成功",type:"success"}),a.$refs.form.resetFields(),e.isEdit=!1,a.isAdd=!1,a.params.page=1,a.getData(a.params)):100004===t.status?a.$message({message:""+t.message,type:"error"}):a.$message({message:"保存失败",type:"error"})}).catch(function(){a.$message({message:"请求失败",type:"error"})})})},cancel:function(e,t){this.$refs.form.resetFields(),e.isEdit=!1,this.isAdd=!1,this.tableData.splice(t,1)},pagination:function(e){this.params.page=e.page,this.params.size=e.limit,this.getData(this.params)},handleSelectionChange:function(e){var t=this;this.checkData=[],this.lodash.map(e,function(e){t.checkData.push({id:e.id,status:e.status})})},getData:function(e){var t=this;e.page--,this.loading=!0,this.$fly.get(s.a.getSuperUsers,e).then(function(a){if(setTimeout(function(){t.loading=!1},1e3),1e5===a.status){var s=a.data,n=s.content,r=s.totalElements;t.tableData=n,t.tableData.map(function(e){e.isEdit=!1}),t.pageInfo={totalElements:parseInt(r),currentPage:e.page+1}}else t.loading=!1,t.$message({message:"请求失败",type:"error"})})}},created:function(){this.getData(this.params)},mounted:function(){this.params.size=this.$refs.pageInfo.pageSizes[0]}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page"},[a("div",{staticClass:"tools-bar"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return t.stopPropagation(),e.append(t)}}},[e._v("新增")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small",disabled:e.checkData.length<1},on:{click:function(t){return t.stopPropagation(),e.remove(t)}}},[e._v("删除")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",attrs:{"header-cell-class-name":"tableHeader",data:e.tableData,"element-loading-text":"拼命加载中",border:"",stripe:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center","label-class-name":"checkLabel"}}),e._v(" "),a("el-table-column",{attrs:{type:"index",width:"50",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"phoneNumber",label:"手机号",align:"center","min-width":"180","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isEdit?a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{prop:"phoneNumber"}},[a("el-input",{ref:"phoneNumberRef",attrs:{type:"text",maxlength:"11"},model:{value:e.form.phoneNumber,callback:function(t){e.$set(e.form,"phoneNumber",t)},expression:"form.phoneNumber"}})],1)],1):a("span",[e._v(e._s(t.row.phoneNumber))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("dateTime")(t.row.createTime,"yyyy-MM-dd hh:mm:ss")))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作人",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.createUser.username))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.isEdit?[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){a.stopPropagation(),e.save(t.row,t.$index)}}},[e._v("保存")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){a.stopPropagation(),e.cancel(t.row,t.$index)}}},[e._v("取消")])]:void 0}}])})],1),e._v(" "),a("pagination",{ref:"pageInfo",attrs:{total:e.pageInfo.totalElements,page:e.pageInfo.currentPage},on:{"update:page":function(t){e.$set(e.pageInfo,"currentPage",t)},pagination:e.pagination}})],1)},staticRenderFns:[]};var o=a("VU/8")(r,i,!1,function(e){a("ZJZv")},"data-v-f71e1396",null);t.default=o.exports},ZJZv:function(e,t){}});
//# sourceMappingURL=0.147732800b927d239d79.js.map