{"version":3,"sources":["webpack:///src/pages/zhiyuan/banner/add.vue","webpack:///./src/pages/zhiyuan/banner/add.vue?fb65","webpack:///./src/pages/zhiyuan/banner/add.vue"],"names":["add","data","params","title","image","isArticle","pickerVal","content","status","firstData","secondData","threeData","rules","required","message","trigger","type","validator","rule","value","callback","length","Error","timeDialog","addForm","publishTime","pickerOptions2","disabledDate","time","getTime","Date","now","formRules","components","upload","Tinymce","watch","methods","release","this","postData","utils","zhiyuan_bannerPublishNow","timeRelease","_this","$refs","validate","valid","resetFields","submit","zhiyuan_bannerSave","refs","links","_this2","console","log","_params","id","moduleId","$route","query","$fly","post","identification","releaseTime","picture","articleInfoId","then","$message","duration","goBack","catch","save","zhiyuan_bannerPublishDelay","cancel","selectChange","e","isLink","url","firstChange","init","index","lodash","findIndex","item","specialTopicInfoConditionBeans","secondChange","atricleSelectBeanList","getQueryCondition","_this3","get","bannerQueryCondition","productId","isUndefined","created","_this4","zhiyuan_bannerDetail","_data$data","_id","specialTopicInfoId","moduleConditionId","banner_add","render","_vm","_h","$createElement","_c","_self","staticClass","_v","attrs","size","on","click","ref","model","label-width","label","prop","span","placeholder","maxlength","$$v","$set","expression","path","width","height","change","_l","key","name","visible","close-on-click-modal","update:visible","$event","inline-message","label-suffix","picker-options","slot","staticRenderFns","Component","__webpack_require__","normalizeComponent","__webpack_exports__"],"mappings":"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","file":"static/js/16.15d58fc1f9efcf5cb568.js","sourcesContent":["<template>\r\n  <div class=\"page\">\r\n    <div class=\"tools-bar\">\r\n      <div class=\"left-wrap\">\r\n        <back></back>\r\n      </div>\r\n      <div class=\"button-wrap\">\r\n        <el-button type=\"primary\" size=\"small\" @click=\"release\">直接发布</el-button>\r\n        <el-button type=\"info\" size=\"small\" @click=\"timeRelease\">定时发布</el-button>\r\n        <el-button type=\"warning\" size=\"small\" @click=\"submit\">草稿</el-button>\r\n      </div>\r\n    </div>\r\n    <el-form ref=\"form\" :model=\"params\" :rules=\"rules\" label-width=\"80px\">\r\n      <el-form-item label=\"标题\" prop=\"title\">\r\n        <el-col :span='12'>\r\n          <el-input v-model=\"params.title\" placeholder=\"请输入标题\" maxlength=\"20\"></el-input>\r\n        </el-col>\r\n      </el-form-item>\r\n      <el-form-item label=\"封面\" prop=\"image\">\r\n        <upload v-model=\"params.image\" path=\"image/article/\" width=\"735\" height=\"450\"></upload>\r\n      </el-form-item>\r\n      <el-form-item label=\"选择文章\">\r\n        <el-switch v-model=\"params.isArticle\" @change=\"selectChange\"></el-switch>\r\n      </el-form-item>\r\n      <el-form-item v-if='params.isArticle' label=\"选择文章\" :prop=\"params.isArticle?'pickerVal':''\">\r\n        <el-select v-model=\"params.pickerVal[0]\" class=\"mRight_15\" placeholder=\"请选择模块\" @change=\"firstChange\">\r\n          <el-option v-for=\"(item,index) in firstData\" :key=\"index\" :label=\"item.name\" :value=\"item.id\"></el-option>\r\n        </el-select>\r\n        <el-select v-model=\"params.pickerVal[1]\" class=\"mRight_15\" placeholder=\"请选择专题\" @change=\"secondChange\">\r\n          <el-option v-for=\"(item,index) in secondData\" :key=\"index\" :label=\"item.title\" :value=\"item.id\"></el-option>\r\n        </el-select>\r\n        <el-select v-model=\"params.pickerVal[2]\" placeholder=\"请选择文章\">\r\n          <el-option v-for=\"(item,index) in threeData\" :key=\"index\" :label=\"item.title\" :value=\"item.id\"></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item v-else :prop=\"!params.isArticle?'content':''\">\r\n        <el-col :span=\"18\">\r\n          <Tinymce :height=\"600\" ref=\"editor\" v-model=\"params.content\" />\r\n        </el-col>\r\n      </el-form-item>\r\n    </el-form>\r\n    <el-dialog title=\"定时发布\" :visible.sync=\"timeDialog\" width=\"500px\" :close-on-click-modal=\"false\">\r\n      <el-form :model=\"addForm\" inline-message ref=\"addForm\" :rules=\"formRules\" label-suffix=\":\" label-width=\"100\">\r\n        <el-form-item label=\"发布时间\" prop=\"publishTime\">\r\n          <el-col :span='12'>\r\n            <el-date-picker v-model=\"addForm.publishTime\" type=\"datetime\" :picker-options=\"pickerOptions2\" placeholder=\"请选择发布时间\" class=\"full\">\r\n            </el-date-picker>\r\n          </el-col>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"cancel\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"save\">确定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { api } from '@/utils'\r\nimport Tinymce from '@/components/Tinymce'\r\nimport { upload } from '@/components'\r\nexport default {\r\n  data () {\r\n    let validatePickerVal = (rule, value, callback) => {\r\n      if (value.length < 3) {\r\n        callback(new Error('请选择模块、专题和文章'))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    return {\r\n      params: {\r\n        title: '',\r\n        image: '',\r\n        isArticle: true,\r\n        pickerVal: [],\r\n        content: '',\r\n        status: ''\r\n      },\r\n      firstData: [],\r\n      secondData: [],\r\n      threeData: [],\r\n      rules: {\r\n        title: [{ required: true, message: '标题不能为空，且最多输入20个字符', trigger: 'blur' }],\r\n        content: [{ required: true, message: '请输入内容', trigger: 'blur' }],\r\n        image: [{ type: 'string', required: true, message: '封面不能为空，且大小限制于735*450', trigger: 'blur' }],\r\n        pickerVal: [{ required: true, validator: validatePickerVal, trigger: 'change' }]\r\n      },\r\n      timeDialog: false,\r\n      addForm: {\r\n        publishTime: ''\r\n      },\r\n      pickerOptions2: {\r\n        disabledDate (time) {\r\n          return time.getTime() < Date.now() - 8.64e7\r\n        }\r\n      },\r\n      formRules: {\r\n        publishTime: [{ type: 'date', required: true, message: '时间不能为空', trigger: 'change' }]\r\n      }\r\n    }\r\n  },\r\n  components: {\r\n    upload,\r\n    Tinymce\r\n  },\r\n  watch: {\r\n    pickerVal () {\r\n\r\n    }\r\n  },\r\n  methods: {\r\n    // 直接发布\r\n    release () {\r\n      this.params.status = 1\r\n      this.postData('form', api.zhiyuan_bannerPublishNow)\r\n    },\r\n    timeRelease () {\r\n      this.$refs['form'].validate((valid) => {\r\n        if (valid) {\r\n          this.timeDialog = true\r\n          if (this.$refs['addForm']) {\r\n            this.$refs['addForm'].resetFields()\r\n          }\r\n        }\r\n      })\r\n    },\r\n    // 保存为草稿\r\n    submit () {\r\n      this.params.status = 2\r\n      this.postData('form', api.zhiyuan_bannerSave)\r\n    },\r\n    postData (refs, links) {\r\n      this.$refs[refs].validate((valid) => {\r\n        if (valid) {\r\n          let { title, image, isArticle, id, content, pickerVal, status } = this.params\r\n          let publishTime = this.timeDialog ? new Date(this.addForm.publishTime).getTime() : null\r\n          let moduleId\r\n          if (this.$route.params.type === 'edit') {\r\n            moduleId = this.params.moduleId\r\n          } else {\r\n            moduleId = this.$route.query.moduleId\r\n          }\r\n          console.log(pickerVal)\r\n          this.$fly.post(links, {\r\n            moduleId: moduleId,\r\n            id,\r\n            title,\r\n            identification: isArticle ? 2 : 1,\r\n            releaseTime: publishTime,\r\n            picture: image,\r\n            content: !isArticle ? content : null,\r\n            articleInfoId: isArticle ? pickerVal[2] : null,\r\n            status: status\r\n          }).then(data => {\r\n            this.$message({\r\n              message: '保存成功',\r\n              duration: 2000,\r\n              type: 'success'\r\n            })\r\n            this.$refs['form'].resetFields()\r\n            this.timeDialog = false\r\n            this.goBack()\r\n          }).catch(() => {\r\n            this.$message({\r\n              message: '保存失败',\r\n              duration: 2000,\r\n              type: 'error'\r\n            })\r\n          })\r\n        } else {\r\n          console.log('error submit!!')\r\n          return false\r\n        }\r\n      })\r\n    },\r\n    // 定时发布\r\n    save () {\r\n      this.params.status = 4\r\n      this.postData('addForm', api.zhiyuan_bannerPublishDelay)\r\n    },\r\n    cancel () {\r\n      this.$refs['addForm'].resetFields()\r\n      this.timeDialog = false\r\n    },\r\n    selectChange (e) {\r\n      this.isLink = e\r\n      if (e) {\r\n        this.params.content = ''\r\n      } else {\r\n        this.params.url = ''\r\n      }\r\n    },\r\n    firstChange (e, init) {\r\n      if (!init) {\r\n        this.params.pickerVal[1] = null\r\n        this.params.pickerVal[2] = null\r\n      }\r\n      let index = this.lodash.findIndex(this.firstData, (item) => (item.id === e))\r\n      this.secondData = this.firstData[index].specialTopicInfoConditionBeans\r\n    },\r\n    secondChange (e) {\r\n      let index = this.lodash.findIndex(this.secondData, (item) => (item.id === e))\r\n      this.threeData = this.secondData[index].atricleSelectBeanList\r\n    },\r\n    getQueryCondition () {\r\n      this.$fly.get(api.bannerQueryCondition, { productId: 3 }).then(data => {\r\n        if (data.status === 100000) {\r\n          this.firstData = data.data\r\n          if (this.params.pickerVal.length) {\r\n            if (!this.lodash.isUndefined(this.params.pickerVal[0])) {\r\n              this.firstChange(this.params.pickerVal[0], true)\r\n              if (!this.lodash.isUndefined(this.params.pickerVal[1])) {\r\n                this.secondChange(this.params.pickerVal[1])\r\n              }\r\n            }\r\n          }\r\n        } else {\r\n          this.$message({\r\n            message: '请求失败',\r\n            duration: 2000,\r\n            type: 'error'\r\n          })\r\n        }\r\n      }).catch(() => {\r\n        this.$message({\r\n          message: '请求失败',\r\n          duration: 2000,\r\n          type: 'error'\r\n        })\r\n      })\r\n    }\r\n  },\r\n  created () {\r\n    let { type } = this.$route.params\r\n    let { id } = this.$route.query\r\n    if (type === 'edit') {\r\n      this.$fly.get(api.zhiyuan_bannerDetail, {\r\n        id\r\n      }).then(data => {\r\n        if (data.status === 100000) {\r\n          let { id, articleInfoId, content, title, identification, picture, moduleId, specialTopicInfoId, moduleConditionId } = data.data\r\n          this.params.id = id\r\n          this.params.title = title\r\n          this.params.content = content\r\n          this.params.moduleId = moduleId\r\n          if (identification === 1) {\r\n            this.params.isArticle = false\r\n          } else {\r\n            this.params.isArticle = true\r\n          }\r\n          this.params.image = picture\r\n          if (identification === 2) {\r\n            this.params.pickerVal[0] = moduleConditionId\r\n            this.params.pickerVal[1] = specialTopicInfoId\r\n            this.params.pickerVal[2] = articleInfoId\r\n          } else {\r\n            this.params.pickerVal = []\r\n          }\r\n          this.getQueryCondition()\r\n        } else {\r\n          this.$message({\r\n            message: '请求失败',\r\n            duration: 2000,\r\n            type: 'error'\r\n          })\r\n        }\r\n      }).catch(() => {\r\n        this.$message({\r\n          message: '请求失败',\r\n          duration: 2000,\r\n          type: 'error'\r\n        })\r\n      })\r\n    } else {\r\n      this.getQueryCondition()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/zhiyuan/banner/add.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page\"},[_c('div',{staticClass:\"tools-bar\"},[_c('div',{staticClass:\"left-wrap\"},[_c('back')],1),_vm._v(\" \"),_c('div',{staticClass:\"button-wrap\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":_vm.release}},[_vm._v(\"直接发布\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"info\",\"size\":\"small\"},on:{\"click\":_vm.timeRelease}},[_vm._v(\"定时发布\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"warning\",\"size\":\"small\"},on:{\"click\":_vm.submit}},[_vm._v(\"草稿\")])],1)]),_vm._v(\" \"),_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.params,\"rules\":_vm.rules,\"label-width\":\"80px\"}},[_c('el-form-item',{attrs:{\"label\":\"标题\",\"prop\":\"title\"}},[_c('el-col',{attrs:{\"span\":12}},[_c('el-input',{attrs:{\"placeholder\":\"请输入标题\",\"maxlength\":\"20\"},model:{value:(_vm.params.title),callback:function ($$v) {_vm.$set(_vm.params, \"title\", $$v)},expression:\"params.title\"}})],1)],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"封面\",\"prop\":\"image\"}},[_c('upload',{attrs:{\"path\":\"image/article/\",\"width\":\"735\",\"height\":\"450\"},model:{value:(_vm.params.image),callback:function ($$v) {_vm.$set(_vm.params, \"image\", $$v)},expression:\"params.image\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"选择文章\"}},[_c('el-switch',{on:{\"change\":_vm.selectChange},model:{value:(_vm.params.isArticle),callback:function ($$v) {_vm.$set(_vm.params, \"isArticle\", $$v)},expression:\"params.isArticle\"}})],1),_vm._v(\" \"),(_vm.params.isArticle)?_c('el-form-item',{attrs:{\"label\":\"选择文章\",\"prop\":_vm.params.isArticle?'pickerVal':''}},[_c('el-select',{staticClass:\"mRight_15\",attrs:{\"placeholder\":\"请选择模块\"},on:{\"change\":_vm.firstChange},model:{value:(_vm.params.pickerVal[0]),callback:function ($$v) {_vm.$set(_vm.params.pickerVal, 0, $$v)},expression:\"params.pickerVal[0]\"}},_vm._l((_vm.firstData),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item.name,\"value\":item.id}})})),_vm._v(\" \"),_c('el-select',{staticClass:\"mRight_15\",attrs:{\"placeholder\":\"请选择专题\"},on:{\"change\":_vm.secondChange},model:{value:(_vm.params.pickerVal[1]),callback:function ($$v) {_vm.$set(_vm.params.pickerVal, 1, $$v)},expression:\"params.pickerVal[1]\"}},_vm._l((_vm.secondData),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item.title,\"value\":item.id}})})),_vm._v(\" \"),_c('el-select',{attrs:{\"placeholder\":\"请选择文章\"},model:{value:(_vm.params.pickerVal[2]),callback:function ($$v) {_vm.$set(_vm.params.pickerVal, 2, $$v)},expression:\"params.pickerVal[2]\"}},_vm._l((_vm.threeData),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item.title,\"value\":item.id}})}))],1):_c('el-form-item',{attrs:{\"prop\":!_vm.params.isArticle?'content':''}},[_c('el-col',{attrs:{\"span\":18}},[_c('Tinymce',{ref:\"editor\",attrs:{\"height\":600},model:{value:(_vm.params.content),callback:function ($$v) {_vm.$set(_vm.params, \"content\", $$v)},expression:\"params.content\"}})],1)],1)],1),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":\"定时发布\",\"visible\":_vm.timeDialog,\"width\":\"500px\",\"close-on-click-modal\":false},on:{\"update:visible\":function($event){_vm.timeDialog=$event}}},[_c('el-form',{ref:\"addForm\",attrs:{\"model\":_vm.addForm,\"inline-message\":\"\",\"rules\":_vm.formRules,\"label-suffix\":\":\",\"label-width\":\"100\"}},[_c('el-form-item',{attrs:{\"label\":\"发布时间\",\"prop\":\"publishTime\"}},[_c('el-col',{attrs:{\"span\":12}},[_c('el-date-picker',{staticClass:\"full\",attrs:{\"type\":\"datetime\",\"picker-options\":_vm.pickerOptions2,\"placeholder\":\"请选择发布时间\"},model:{value:(_vm.addForm.publishTime),callback:function ($$v) {_vm.$set(_vm.addForm, \"publishTime\", $$v)},expression:\"addForm.publishTime\"}})],1)],1)],1),_vm._v(\" \"),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":_vm.cancel}},[_vm._v(\"取消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.save}},[_vm._v(\"确定\")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-633ef14d\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/zhiyuan/banner/add.vue\n// module id = null\n// module chunks = ","var normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./add.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./add.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-633ef14d\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./add.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/zhiyuan/banner/add.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}