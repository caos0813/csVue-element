webpackJsonp([10],{fb15:function(e,a){},x1R6:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=t("5aCZ"),l=t("0xDb"),i=t("bGai"),r={data:function(){return{rules:{title:[{required:!0,message:"文章标题不能为空，且最多输入20个字符",trigger:"blur"}],tagVal:[{required:!0,message:"请选择文章标签",trigger:"change"}],specialVal:[{required:!0,message:"请选择专题",trigger:"change"}],path:[{type:"string",required:!0,message:"请上传类型文件",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]},params:{title:"",isTag:!1,tagVal:"",specialVal:"",type:0,path:"",image:"",introduction:"",content:""},tagData:[],specialData:[],typeData:[{id:0,label:"纯文本"},{id:1,label:"音频"},{id:2,label:"视频"}],timeDialog:!1,addForm:{publishTime:""},pickerOptions2:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},formRules:{publishTime:[{type:"date",required:!0,message:"时间不能为空",trigger:"change"}]},moduleIds:""}},components:{upload:i.f,Tinymce:s.a,picker:i.e},methods:{selectChange:function(e){this.params.isTag=e},typeChange:function(e){this.params.path=""},release:function(){this.postData("form",l.a.zhiyuan_articlePublishNow,1)},timeRelease:function(){var e=this;this.$refs.form.validate(function(a){a&&(e.timeDialog=!0,e.$refs.addForm&&e.$refs.addForm.resetFields())})},save:function(){this.postData("addForm",l.a.zhiyuan_articlePublishDelay,4)},cancel:function(){this.$refs.addForm.resetFields(),this.timeDialog=!1},submit:function(){this.postData("form",l.a.zhiyuan_articleHandle,2)},postData:function(e,a,t){var s=this;this.$refs[e].validate(function(e){if(e){var l=s.params,i=l.id,r=l.title,o=l.isTag,n=l.tagVal,p=l.specialVal,c=l.type,m=l.path,u=l.image,d=l.introduction,f=l.content;console.log(i);var g=void 0;g="edit"===s.$route.params.type?s.params.moduleId:s.moduleIds;var h=s.timeDialog?new Date(s.addForm.publishTime).getTime():null;s.$fly.post(a,{moduleId:g,id:i,title:r,specialTopicInfoId:!0===o?null:p,label:!0===o?n:null,fileType:c,videoFile:m,picture:u,content:f,introduction:d,releaseTime:h,status:t}).then(function(e){1e5===e.status?(s.$message({message:"保存成功",duration:2e3,type:"success"}),s.$refs.form.resetFields(),s.timeDialog=!1,s.goBack()):s.$message({message:"保存失败",type:"error"})}).catch(function(){s.$message({message:"请求失败",duration:2e3,type:"error"})})}})},getArticleMajor:function(){var e=this,a=void 0;a="edit"===this.$route.params.type?this.params.moduleId:this.$route.query.moduleId,this.$fly.get(l.a.queryArticleInfoCondition,{moduleId:a}).then(function(a){var t=a.label,s=a.specialTopicInfoBean;e.tagData=t,e.specialData=s}).catch(function(){e.$message({message:"请求失败",duration:2e3,type:"error"})})}},created:function(){var e=this,a=this.$route.params.type,t=this.$route.query,s=t.id,i=t.moduleId;this.moduleIds=i,"edit"===a?this.$fly.get(l.a.zhiyuan_articleDetail,{id:s}).then(function(a){if(1e5===a.status){var t=a.data,s=t.fileType,l=t.videoFile,i=t.picture,r=t.specialTopicInfoTitle,o=t.articleInfoLabelId,n=t.specialTopicInfoId,p=t.content,c=t.title,m=t.introduction,u=t.moduleId,d=t.id;e.params.title=c,e.params.content=p,e.params.introduction=m,e.params.type=s,e.params.path=l,e.params.image=i,e.params.moduleId=u,e.params.id=d,null===r?(e.params.isTag=!0,e.params.tagVal=o):(e.params.isTag=!1,e.params.specialVal=n),e.getArticleMajor()}else e.$message({message:"查询失败",duration:2e3,type:"error"})}).catch(function(){e.$message({message:"请求失败",duration:2e3,type:"error"})}):this.getArticleMajor()}},o={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"page"},[t("div",{staticClass:"tools-bar"},[t("div",{staticClass:"left-wrap"},[t("back")],1),e._v(" "),t("div",{staticClass:"button-wrap"},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.release}},[e._v("直接发布")]),e._v(" "),t("el-button",{attrs:{type:"info",size:"small"},on:{click:e.timeRelease}},[e._v("定时发布")]),e._v(" "),t("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.submit}},[e._v("草稿")])],1)]),e._v(" "),t("el-form",{ref:"form",attrs:{model:e.params,rules:e.rules,"label-width":"90px","label-suffix":":"}},[t("el-form-item",{attrs:{label:"标题",prop:"title"}},[t("el-col",{attrs:{span:12}},[t("el-input",{attrs:{maxlength:"20"},model:{value:e.params.title,callback:function(a){e.$set(e.params,"title",a)},expression:"params.title"}})],1)],1),e._v(" "),6!==e.moduleId?t("el-form-item",{attrs:{label:"文章标签",prop:"isTag"}},[t("el-col",{attrs:{span:6}},[t("el-switch",{on:{change:e.selectChange},model:{value:e.params.isTag,callback:function(a){e.$set(e.params,"isTag",a)},expression:"params.isTag"}})],1)],1):e._e(),e._v(" "),e.params.isTag?t("el-form-item",{attrs:{label:"文章标签",prop:"tagVal"}},[t("el-col",{attrs:{span:6}},[t("el-select",{staticClass:"full",attrs:{placeholder:"请选择标签"},model:{value:e.params.tagVal,callback:function(a){e.$set(e.params,"tagVal",a)},expression:"params.tagVal"}},e._l(e.tagData,function(e,a){return t("el-option",{key:a,attrs:{label:e.name,value:e.id}})}))],1)],1):t("el-form-item",{attrs:{label:"专题",prop:"specialVal"}},[t("el-col",{attrs:{span:6}},[t("el-select",{staticClass:"full",attrs:{placeholder:"请选择专题"},model:{value:e.params.specialVal,callback:function(a){e.$set(e.params,"specialVal",a)},expression:"params.specialVal"}},e._l(e.specialData,function(e,a){return t("el-option",{key:a,attrs:{label:e.title,value:e.id}})}))],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"类型",prop:"type"}},[t("el-col",{attrs:{span:6}},[t("el-select",{staticClass:"full",attrs:{placeholder:"请选择类型",size:"small"},on:{change:e.typeChange},model:{value:e.params.type,callback:function(a){e.$set(e.params,"type",a)},expression:"params.type"}},e._l(e.typeData,function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.id}})}))],1)],1),e._v(" "),0!==e.params.type?t("el-form-item",{attrs:{label:"文件",prop:"path"}},[1===e.params.type?t("upload",{attrs:{type:"audio",accept:"audio/*",path:"audio/article/"},model:{value:e.params.path,callback:function(a){e.$set(e.params,"path",a)},expression:"params.path"}}):e._e(),e._v(" "),2===e.params.type?t("upload",{attrs:{type:"video",accept:"video/*",path:"video/article/"},model:{value:e.params.path,callback:function(a){e.$set(e.params,"path",a)},expression:"params.path"}}):e._e()],1):e._e(),e._v(" "),t("el-form-item",{attrs:{label:"封面",prop:"image"}},[t("upload",{attrs:{path:"image/article/",width:"1125",height:"750"},model:{value:e.params.image,callback:function(a){e.$set(e.params,"image",a)},expression:"params.image"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"简介",prop:"introduction"}},[t("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入简介"},model:{value:e.params.introduction,callback:function(a){e.$set(e.params,"introduction",a)},expression:"params.introduction"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"content"}},[t("el-col",{attrs:{span:18}},[t("Tinymce",{ref:"editor",attrs:{height:600},model:{value:e.params.content,callback:function(a){e.$set(e.params,"content",a)},expression:"params.content"}})],1)],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"定时发布",visible:e.timeDialog,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(a){e.timeDialog=a}}},[t("el-form",{ref:"addForm",attrs:{model:e.addForm,"inline-message":"",rules:e.formRules,"label-suffix":":","label-width":"100"}},[t("el-form-item",{attrs:{label:"发布时间",prop:"publishTime"}},[t("el-col",{attrs:{span:12}},[t("el-date-picker",{staticClass:"full",attrs:{type:"datetime","picker-options":e.pickerOptions2,placeholder:"请选择发布时间"},model:{value:e.addForm.publishTime,callback:function(a){e.$set(e.addForm,"publishTime",a)},expression:"addForm.publishTime"}})],1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancel}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[]};var n=t("VU/8")(r,o,!1,function(e){t("fb15")},"data-v-3c735379",null);a.default=n.exports}});
//# sourceMappingURL=10.c8ed214b9e2da63271b6.js.map