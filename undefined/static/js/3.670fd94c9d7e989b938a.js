webpackJsonp([3],{D1Je:function(n,e,t){(n.exports=t("FZ+f")(!0)).push([n.i,"\n.tools-bar[data-v-a53e23f8] {\n  -webkit-box-pack: end;\n      -ms-flex-pack: end;\n          justify-content: flex-end;\n}\n","",{version:3,sources:["D:/work/junyang_admin/src/pages/system/D:/work/junyang_admin/src/pages/system/user-list.vue"],names:[],mappings:";AAsTA;EACE,sBAAyB;MAAzB,mBAAyB;UAAzB,0BAAyB;CAC1B",file:"user-list.vue",sourcesContent:["$light:#fff;\r\n$black:#000;\r\n$gray:#eee;\r\n$gray-ee:#eef1f6;\r\n$stable-dc:#dcdfe6;\r\n$stable-f5:#f5f7fa;\r\n$dark03:#303133 !default;\r\n$color-primary: #409EFF !default;\r\n\r\n$font-size-12:12px;\r\n$font-size-14:14px;\r\n$font-size-16:16px;\r\n$font-size-18:18px;\r\n$font-size-20:20px;\r\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.tools-bar {\r\n  justify-content: flex-end;\r\n}\r\n"],sourceRoot:""}])},JSff:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=t("0xDb"),a=t("bGai"),r=t("lbHh"),o=t.n(r),l={data:function(){var n=this;return{params:{page:1},checkData:[],pageInfo:{totalElements:0,currentPage:1},tableData:[],loading:!1,dialogResetPassword:!1,form:{oldPassword:null,newPassword:null,surePassword:""},rules:{oldPassword:[{required:!0,validator:function(e,t,a){t?n.$fly.post(s.a.existPassword,{id:n.userId,oldPassword:t}).then(function(e){1e5===e.status?e.data?a():a(new Error("旧密码错误")):n.$message({message:"请求错误",type:"error"})}):a(new Error("请输入旧密码"))},trigger:"blur"}],newPassword:[{required:!0,validator:function(e,t,s){t?/^[0-9a-zA_Z]+$/.test(t)?n.form.oldPassword===t?s(new Error("两次密码不能一致")):s():s(new Error("密码只能是英文字母或数字")):s(new Error("请输入新密码"))},trigger:"blur"}],surePassword:[{required:!0,validator:function(e,t,s){t?t!==n.form.newPassword?s(new Error("密码不一致")):s():s(new Error("请输入确认密码"))},trigger:"blur"}]},userId:"",username:"",isDeleteShelf:!1}},components:{listHandle:a.c,pagination:a.d},methods:{handleDelete:function(){var n=this;this.checkIds=[],confirm("您确定将选择的用户禁用吗？","提示").then(function(){for(var e=0;e<n.checkData.length;e++){if("DISABLED"===n.checkData[e].status)return n.$message.error("已禁用的用户不能禁用"),void(n.checkIds=[]);n.checkIds.push(n.checkData[e].id)}n.checkIds.length>0&&n.$fly.post(s.a["system/userDelete"],n.checkIds).then(function(e){if(!e.data)return n.$message({message:""+e.message,duration:2e3,type:"error"});n.$message({message:"禁用成功",duration:2e3,type:"success"}),n.refresh()}).catch(function(){n.$message({message:"禁用失败",duration:2e3,type:"error"})})})},filterTag:function(n,e){return console.log(n),e.status===n},filterHandler:function(n,e,t){var s=t.property;return console.log(s),e[s]===n},resetPassword:function(n){var e=this;console.log(n),this.userId=n.id,this.username=n.username,this.dialogResetPassword=!0,this.$nextTick(function(){e.$refs.form.resetFields()})},cancel:function(){this.$refs.form.resetFields(),this.dialogResetPassword=!1},save:function(){var n=this;this.$refs.form.validate(function(e){if(e){var t=n.form,a=t.oldPassword,r=t.newPassword;n.$fly.post(s.a.resetPassword,{id:n.userId,oldPassword:a,newPassword:r}).then(function(e){1e5===e.status?(n.$refs.form.resetFields(),n.dialogResetPassword=!1,n.$message({message:"重置密码成功",type:"success"}),n.username===o.a.getJSON("user").userName&&n.signOut("您重置了当前用户的密码，请重新登录")):n.$message({message:"重置密码失败",type:"error"})})}})},refresh:function(){this.params.page=1,this.isDeleteShelf?this.signOut("您删除了当前用户，请重新登录"):this.getData(this.params)},handleSelectionChange:function(n){var e=this;this.checkData=[],this.lodash.map(n,function(n){e.checkData.push({id:n.id,status:n.status}),n.username===o.a.getJSON("user").userName&&(e.isDeleteShelf=!0)})},signOut:function(n){var e=this;this.$message({message:""+n,type:"warning"}),setTimeout(function(){o.a.remove("user"),e.$router.replace({name:"login"})},500)},pagination:function(n){this.params.page=n.page,this.params.size=n.limit,this.getData(this.params)},getData:function(n){var e=this;n.page--,this.loading=!0,this.$fly.get(s.a.getUsers,n).then(function(t){setTimeout(function(){e.loading=!1},1e3);var s=t.data,a=s.content,r=s.totalElements;e.tableData=a,e.pageInfo={totalElements:parseInt(r),currentPage:n.page+1}})}},created:function(){this.getData(this.params)},mounted:function(){this.params.size=this.$refs.pageInfo.pageSizes[0]}},i=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"page"},[t("div",{staticClass:"tools-bar"},[t("listHandle",{attrs:{showSoldout:!1,checkData:n.checkData,showDelete:!1},on:{refresh:n.refresh}},[t("el-button",{attrs:{type:"danger",size:"small"},on:{click:n.handleDelete}},[n._v("禁用")])],1)],1),n._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],ref:"multipleTable",attrs:{"header-cell-class-name":"tableHeader",data:n.tableData,"element-loading-text":"拼命加载中",border:"",stripe:"","filter-method":n.filterHandler},on:{"selection-change":n.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55",align:"center","label-class-name":"checkLabel"}}),n._v(" "),t("el-table-column",{attrs:{type:"index",width:"50",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{prop:"nickname",label:"昵称",align:"center","min-width":"150","show-overflow-tooltip":""}}),n._v(" "),t("el-table-column",{attrs:{prop:"username",label:"账号",align:"center","min-width":"150","show-overflow-tooltip":""}}),n._v(" "),t("el-table-column",{attrs:{prop:"phoneNumber",label:"手机号",align:"center",width:"150"}}),n._v(" "),t("el-table-column",{attrs:{prop:"department",label:"部门",align:"center"},scopedSlots:n._u([{key:"default",fn:function(e){return e.row.department?[n._v(n._s(e.row.department.name))]:void 0}}])}),n._v(" "),t("el-table-column",{attrs:{label:"状态",align:"center",filters:[{text:"禁用",value:"DISABLED"},{text:"可用",value:"ENABLED"}],"filter-method":n.filterTag,"filter-placement":"bottom-end"},scopedSlots:n._u([{key:"default",fn:function(e){return["DISABLED"===e.row.status?t("el-tag",{attrs:{type:"danger"}},[n._v("禁用")]):t("el-tag",{attrs:{type:"success"}},[n._v("可用")])]}}])}),n._v(" "),t("el-table-column",{attrs:{label:"角色",align:"center"},scopedSlots:n._u([{key:"default",fn:function(e){return 1===e.row.roles.length?[n._v(n._s(e.row.roles[0].name))]:void 0}}])}),n._v(" "),t("el-table-column",{attrs:{label:"创建时间",width:"180",align:"center"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v(n._s(n._f("dateTime")(e.row.createTime,"yyyy-MM-dd hh:mm:ss")))]}}])}),n._v(" "),t("el-table-column",{attrs:{prop:"remark",label:"备注","min-width":"200","show-overflow-tooltip":"",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{label:"操作",width:"120",align:"center"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{type:"text ",size:"mini"}},[t("router-link",{attrs:{to:{name:"system/user",params:{type:"edit"},query:{id:e.row.id}},tag:"span"}},[n._v("编辑")])],1),n._v(" "),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){t.stopPropagation(),n.resetPassword(e.row)}}},[n._v("重置密码")])]}}])})],1),n._v(" "),t("pagination",{ref:"pageInfo",attrs:{total:n.pageInfo.totalElements,page:n.pageInfo.currentPage},on:{"update:page":function(e){n.$set(n.pageInfo,"currentPage",e)},pagination:n.pagination}}),n._v(" "),t("el-dialog",{attrs:{title:"重置密码",visible:n.dialogResetPassword,"close-on-click-modal":!1},on:{"update:visible":function(e){n.dialogResetPassword=e}}},[t("el-form",{ref:"form",attrs:{model:n.form,rules:n.rules,"label-width":"100px","label-suffix":":"}},[t("el-form-item",{attrs:{label:"旧密码",prop:"oldPassword"}},[t("el-input",{attrs:{type:"password"},model:{value:n.form.oldPassword,callback:function(e){n.$set(n.form,"oldPassword",e)},expression:"form.oldPassword"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[t("el-input",{attrs:{type:"password"},model:{value:n.form.newPassword,callback:function(e){n.$set(n.form,"newPassword",e)},expression:"form.newPassword"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"确认密码",prop:"surePassword"}},[t("el-input",{attrs:{type:"password"},model:{value:n.form.surePassword,callback:function(e){n.$set(n.form,"surePassword",e)},expression:"form.surePassword"}})],1)],1),n._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(e){return e.stopPropagation(),n.cancel(e)}}},[n._v("取 消")]),n._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),n.save(e)}}},[n._v("确 定")])],1)],1)],1)};i._withStripped=!0;var c={render:i,staticRenderFns:[]},u=c;var d=!1;var f=t("VU/8")(l,u,!1,function(n){d||t("yCz5")},"data-v-a53e23f8",null);f.options.__file="src/pages/system/user-list.vue";e.default=f.exports},yCz5:function(n,e,t){var s=t("D1Je");"string"==typeof s&&(s=[[n.i,s,""]]),s.locals&&(n.exports=s.locals);t("rjj0")("23e2ca8c",s,!1,{})}});
//# sourceMappingURL=3.670fd94c9d7e989b938a.js.map